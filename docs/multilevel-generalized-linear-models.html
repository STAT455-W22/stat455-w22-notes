<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Multilevel Generalized Linear Models | Stat 455: Advanced Statistical Modeling Notes</title>
  <meta name="description" content="Chapter 8 Multilevel Generalized Linear Models | Stat 455: Advanced Statistical Modeling Notes" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Multilevel Generalized Linear Models | Stat 455: Advanced Statistical Modeling Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Multilevel Generalized Linear Models | Stat 455: Advanced Statistical Modeling Notes" />
  
  
  



<meta name="date" content="2023-12-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="logistic-regression.html"/>
<link rel="next" href="epilogue.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stat 455 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html"><i class="fa fa-check"></i><b>1</b> Review of Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.1</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#kentucky-derby-data"><i class="fa fa-check"></i><b>1.1.1</b> Kentucky Derby Data</a></li>
<li class="chapter" data-level="1.1.2" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#some-data-wrangling"><i class="fa fa-check"></i><b>1.1.2</b> Some Data Wrangling</a></li>
<li class="chapter" data-level="1.1.3" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#univariate-graphical-summaries"><i class="fa fa-check"></i><b>1.1.3</b> Univariate Graphical Summaries</a></li>
<li class="chapter" data-level="1.1.4" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#bivariate-graphical-summaries"><i class="fa fa-check"></i><b>1.1.4</b> Bivariate Graphical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#simple-linear-regression-model"><i class="fa fa-check"></i><b>1.2</b> Simple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-for-winning-time-and-year"><i class="fa fa-check"></i><b>1.2.1</b> Model for Winning Time and Year</a></li>
<li class="chapter" data-level="1.2.2" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#first-model-r-output"><i class="fa fa-check"></i><b>1.2.2</b> First Model R Output</a></li>
<li class="chapter" data-level="1.2.3" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#checking-model-assumptions"><i class="fa fa-check"></i><b>1.2.3</b> Checking Model Assumptions</a></li>
<li class="chapter" data-level="1.2.4" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#quadratic-term-for-year"><i class="fa fa-check"></i><b>1.2.4</b> Quadratic Term for Year</a></li>
<li class="chapter" data-level="1.2.5" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#quadratic-model-in-r"><i class="fa fa-check"></i><b>1.2.5</b> Quadratic Model in R</a></li>
<li class="chapter" data-level="1.2.6" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#quadratic-model-residual-plots"><i class="fa fa-check"></i><b>1.2.6</b> Quadratic Model Residual Plots</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#multiple-linear-regression-with-two-predictors"><i class="fa fa-check"></i><b>1.3</b> Multiple Linear Regression with Two Predictors</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-with-year-and-fast-track"><i class="fa fa-check"></i><b>1.3.1</b> Model with Year and Fast Track</a></li>
<li class="chapter" data-level="1.3.2" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#multiple-regression-model-in-r"><i class="fa fa-check"></i><b>1.3.2</b> Multiple Regression Model in R</a></li>
<li class="chapter" data-level="1.3.3" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#confidence-intervals-from-mlr-model"><i class="fa fa-check"></i><b>1.3.3</b> Confidence Intervals from MLR Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#slopes-for-fast-non-fast-tracks"><i class="fa fa-check"></i><b>1.3.4</b> Slopes for Fast, non-Fast Tracks</a></li>
<li class="chapter" data-level="1.3.5" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#mlr-model-with-interaction"><i class="fa fa-check"></i><b>1.3.5</b> MLR Model with Interaction</a></li>
<li class="chapter" data-level="1.3.6" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-equations-for-fast-non-fast-tracks"><i class="fa fa-check"></i><b>1.3.6</b> Model Equations for Fast, Non-Fast Tracks</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#building-a-multiple-linear-regression-model"><i class="fa fa-check"></i><b>1.4</b> Building a Multiple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-building-considerations"><i class="fa fa-check"></i><b>1.4.1</b> Model Building Considerations</a></li>
<li class="chapter" data-level="1.4.2" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>1.4.2</b> Model Diagnostics</a></li>
<li class="chapter" data-level="1.4.3" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#three-possible-models"><i class="fa fa-check"></i><b>1.4.3</b> Three Possible Models</a></li>
<li class="chapter" data-level="1.4.4" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#mlr-models-fit-in-r"><i class="fa fa-check"></i><b>1.4.4</b> MLR Models Fit in R</a></li>
<li class="chapter" data-level="1.4.5" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-0a-output"><i class="fa fa-check"></i><b>1.4.5</b> Model 0A Output</a></li>
<li class="chapter" data-level="1.4.6" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-0b-output"><i class="fa fa-check"></i><b>1.4.6</b> Model 0B Output</a></li>
<li class="chapter" data-level="1.4.7" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#model-0c-output"><i class="fa fa-check"></i><b>1.4.7</b> Model 0C Output</a></li>
<li class="chapter" data-level="1.4.8" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>1.4.8</b> Goodness of Fit Tests</a></li>
<li class="chapter" data-level="1.4.9" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#anova-f-statistic"><i class="fa fa-check"></i><b>1.4.9</b> ANOVA F-Statistic</a></li>
<li class="chapter" data-level="1.4.10" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#final-model-residual-plots"><i class="fa fa-check"></i><b>1.4.10</b> Final Model Residual Plots</a></li>
<li class="chapter" data-level="1.4.11" data-path="review-of-multiple-linear-regression.html"><a href="review-of-multiple-linear-regression.html#overall-conclusions"><i class="fa fa-check"></i><b>1.4.11</b> Overall Conclusions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html"><i class="fa fa-check"></i><b>2</b> Introduction to Correlated Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#introduction-to-correlated-data-1"><i class="fa fa-check"></i><b>2.1</b> Introduction to Correlated Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#weight-gain-in-mice-experiment-design-1"><i class="fa fa-check"></i><b>2.1.1</b> Weight Gain in Mice: Experiment Design #1</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#mice-experiment-1-data"><i class="fa fa-check"></i><b>2.1.2</b> Mice Experiment 1 Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-naive-graphical-analysis"><i class="fa fa-check"></i><b>2.1.3</b> A Naive Graphical Analysis</a></li>
<li class="chapter" data-level="2.1.4" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-more-informed-graphical-analysis"><i class="fa fa-check"></i><b>2.1.4</b> A More Informed Graphical Analysis</a></li>
<li class="chapter" data-level="2.1.5" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#table-of-mean-weight-by-diet"><i class="fa fa-check"></i><b>2.1.5</b> Table of Mean Weight By Diet</a></li>
<li class="chapter" data-level="2.1.6" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#table-of-mean-weight-by-diet-and-litter"><i class="fa fa-check"></i><b>2.1.6</b> Table of Mean Weight By Diet and Litter</a></li>
<li class="chapter" data-level="2.1.7" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#assessing-evidence-of-differences"><i class="fa fa-check"></i><b>2.1.7</b> Assessing Evidence of Differences</a></li>
<li class="chapter" data-level="2.1.8" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#an-improper-statistical-analysis"><i class="fa fa-check"></i><b>2.1.8</b> An Improper Statistical Analysis</a></li>
<li class="chapter" data-level="2.1.9" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-more-appropriate-statistical-analysis"><i class="fa fa-check"></i><b>2.1.9</b> A More Appropriate Statistical Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#linear-mixed-effects-models"><i class="fa fa-check"></i><b>2.2</b> Linear Mixed Effects Models</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#llsr-model-for-mice-experiment"><i class="fa fa-check"></i><b>2.2.1</b> LLSR Model for Mice Experiment</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#model-accounting-for-correlation"><i class="fa fa-check"></i><b>2.2.2</b> Model Accounting For Correlation</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#questions-of-interest"><i class="fa fa-check"></i><b>2.2.3</b> Questions of Interest</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#fixed-and-random-effects"><i class="fa fa-check"></i><b>2.2.4</b> Fixed and Random Effects</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#fitting-the-model-in-r"><i class="fa fa-check"></i><b>2.2.5</b> Fitting the Model in R</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#why-not-fixed-effect-for-litter"><i class="fa fa-check"></i><b>2.2.6</b> Why Not Fixed Effect for Litter?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-second-mice-experiment"><i class="fa fa-check"></i><b>2.3</b> A Second Mice Experiment</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#weight-gain-in-mice-experiment-2"><i class="fa fa-check"></i><b>2.3.1</b> Weight Gain in Mice: Experiment 2</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#mice-experiment-2-data"><i class="fa fa-check"></i><b>2.3.2</b> Mice Experiment 2 Data</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-naive-graphical-analysis-for-experiment-2"><i class="fa fa-check"></i><b>2.3.3</b> A Naive Graphical Analysis for Experiment 2</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-more-informed-graphical-analysis-for-experiment-2"><i class="fa fa-check"></i><b>2.3.4</b> A More Informed Graphical Analysis for Experiment 2</a></li>
<li class="chapter" data-level="2.3.5" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#table-of-mean-weight-by-diet-for-experiment-2"><i class="fa fa-check"></i><b>2.3.5</b> Table of Mean Weight By Diet for Experiment 2</a></li>
<li class="chapter" data-level="2.3.6" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#table-comparing-litters-means-by-diet-for-experiment-2"><i class="fa fa-check"></i><b>2.3.6</b> Table Comparing Litters Means by Diet for Experiment 2</a></li>
<li class="chapter" data-level="2.3.7" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#an-inappropriate-model-for-the-second-design"><i class="fa fa-check"></i><b>2.3.7</b> An Inappropriate Model for the Second Design</a></li>
<li class="chapter" data-level="2.3.8" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-more-appropriate-model-for-experiment-2"><i class="fa fa-check"></i><b>2.3.8</b> A More Appropriate Model for Experiment 2</a></li>
<li class="chapter" data-level="2.3.9" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#model-for-litter-means"><i class="fa fa-check"></i><b>2.3.9</b> Model for Litter Means</a></li>
<li class="chapter" data-level="2.3.10" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#fixed-effect-for-litter-in-experiment-2"><i class="fa fa-check"></i><b>2.3.10</b> Fixed Effect for Litter in Experiment 2</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-multilevel-experiment"><i class="fa fa-check"></i><b>2.4</b> A Multilevel Experiment</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#experiment-2-illustration"><i class="fa fa-check"></i><b>2.4.1</b> Experiment 2 Illustration</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#experiment-with-variables-assigned-at-different-levels"><i class="fa fa-check"></i><b>2.4.2</b> Experiment with Variables Assigned at Different Levels</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#experiment-3-data"><i class="fa fa-check"></i><b>2.4.3</b> Experiment 3 Data</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#graphical-analysis-for-experiment-3"><i class="fa fa-check"></i><b>2.4.4</b> Graphical Analysis for Experiment 3</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#an-inappropriate-model-for-the-3rd-design"><i class="fa fa-check"></i><b>2.4.5</b> An Inappropriate Model for the 3rd Design</a></li>
<li class="chapter" data-level="2.4.6" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#a-more-appropriate-model-for-experiment-3"><i class="fa fa-check"></i><b>2.4.6</b> A More Appropriate Model for Experiment 3</a></li>
<li class="chapter" data-level="2.4.7" data-path="introduction-to-correlated-data.html"><a href="introduction-to-correlated-data.html#comparison-of-llsr-and-lme-models"><i class="fa fa-check"></i><b>2.4.7</b> Comparison of LLSR and LME Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>3</b> Multilevel Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multilevel-models.html"><a href="multilevel-models.html#music-performance-anxiety-study-data-and-exploratory-analysis"><i class="fa fa-check"></i><b>3.1</b> Music Performance Anxiety Study: Data and Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="multilevel-models.html"><a href="multilevel-models.html#description-of-the-study"><i class="fa fa-check"></i><b>3.1.1</b> Description of the Study</a></li>
<li class="chapter" data-level="3.1.2" data-path="multilevel-models.html"><a href="multilevel-models.html#variables"><i class="fa fa-check"></i><b>3.1.2</b> Variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="multilevel-models.html"><a href="multilevel-models.html#the-data"><i class="fa fa-check"></i><b>3.1.3</b> The Data</a></li>
<li class="chapter" data-level="3.1.4" data-path="multilevel-models.html"><a href="multilevel-models.html#some-data-wrangling-1"><i class="fa fa-check"></i><b>3.1.4</b> Some Data Wrangling</a></li>
<li class="chapter" data-level="3.1.5" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-structure"><i class="fa fa-check"></i><b>3.1.5</b> Multilevel Structure</a></li>
<li class="chapter" data-level="3.1.6" data-path="multilevel-models.html"><a href="multilevel-models.html#questions-of-interest-1"><i class="fa fa-check"></i><b>3.1.6</b> Questions of Interest</a></li>
<li class="chapter" data-level="3.1.7" data-path="multilevel-models.html"><a href="multilevel-models.html#number-of-performances-by-musician"><i class="fa fa-check"></i><b>3.1.7</b> Number of Performances by Musician</a></li>
<li class="chapter" data-level="3.1.8" data-path="multilevel-models.html"><a href="multilevel-models.html#number-of-performances-of-each-type"><i class="fa fa-check"></i><b>3.1.8</b> Number of Performances of Each Type</a></li>
<li class="chapter" data-level="3.1.9" data-path="multilevel-models.html"><a href="multilevel-models.html#distribution-of-negative-affect-for-all-performances"><i class="fa fa-check"></i><b>3.1.9</b> Distribution of Negative Affect for All Performances</a></li>
<li class="chapter" data-level="3.1.10" data-path="multilevel-models.html"><a href="multilevel-models.html#distribution-of-average-negative-affect-for-each-musician"><i class="fa fa-check"></i><b>3.1.10</b> Distribution of Average Negative Affect for each Musician</a></li>
<li class="chapter" data-level="3.1.11" data-path="multilevel-models.html"><a href="multilevel-models.html#distribution-of-level-two-covariates"><i class="fa fa-check"></i><b>3.1.11</b> Distribution of Level Two Covariates</a></li>
<li class="chapter" data-level="3.1.12" data-path="multilevel-models.html"><a href="multilevel-models.html#distributions-of-nem-pem-absorption"><i class="fa fa-check"></i><b>3.1.12</b> Distributions of NEM, PEM, Absorption</a></li>
<li class="chapter" data-level="3.1.13" data-path="multilevel-models.html"><a href="multilevel-models.html#negative-affect-by-performance-type-audience-type-and-previous-performances"><i class="fa fa-check"></i><b>3.1.13</b> Negative Affect by Performance Type, Audience Type, and Previous Performances</a></li>
<li class="chapter" data-level="3.1.14" data-path="multilevel-models.html"><a href="multilevel-models.html#lattice-plot-for-negative-affect-by-performance-type"><i class="fa fa-check"></i><b>3.1.14</b> Lattice Plot for Negative Affect by Performance Type</a></li>
<li class="chapter" data-level="3.1.15" data-path="multilevel-models.html"><a href="multilevel-models.html#lattice-plot-for-negative-affect-by-audience-type"><i class="fa fa-check"></i><b>3.1.15</b> Lattice Plot for Negative Affect by Audience Type</a></li>
<li class="chapter" data-level="3.1.16" data-path="multilevel-models.html"><a href="multilevel-models.html#lattice-plot-for-previous-performances-vs-negative-affect"><i class="fa fa-check"></i><b>3.1.16</b> Lattice Plot for Previous Performances vs Negative Affect</a></li>
<li class="chapter" data-level="3.1.17" data-path="multilevel-models.html"><a href="multilevel-models.html#negative-affect-by-instrument-type"><i class="fa fa-check"></i><b>3.1.17</b> Negative Affect by Instrument Type</a></li>
<li class="chapter" data-level="3.1.18" data-path="multilevel-models.html"><a href="multilevel-models.html#more-data-wrangling"><i class="fa fa-check"></i><b>3.1.18</b> More Data Wrangling</a></li>
<li class="chapter" data-level="3.1.19" data-path="multilevel-models.html"><a href="multilevel-models.html#lattice-plot-for-large-ensemble-effect"><i class="fa fa-check"></i><b>3.1.19</b> Lattice Plot for Large Ensemble Effect</a></li>
<li class="chapter" data-level="3.1.20" data-path="multilevel-models.html"><a href="multilevel-models.html#boxplots-for-orchestral-instrument-effect"><i class="fa fa-check"></i><b>3.1.20</b> Boxplots for Orchestral Instrument Effect</a></li>
<li class="chapter" data-level="3.1.21" data-path="multilevel-models.html"><a href="multilevel-models.html#negative-affect-by-pem-nem-absorption"><i class="fa fa-check"></i><b>3.1.21</b> Negative Affect by PEM, NEM, Absorption</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="multilevel-models.html"><a href="multilevel-models.html#modeling-the-musician-data"><i class="fa fa-check"></i><b>3.2</b> Modeling the Musician Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="multilevel-models.html"><a href="multilevel-models.html#model-notation"><i class="fa fa-check"></i><b>3.2.1</b> Model Notation</a></li>
<li class="chapter" data-level="3.2.2" data-path="multilevel-models.html"><a href="multilevel-models.html#llsr-model-clearly-inappropriate"><i class="fa fa-check"></i><b>3.2.2</b> LLSR Model (Clearly inappropriate)</a></li>
<li class="chapter" data-level="3.2.3" data-path="multilevel-models.html"><a href="multilevel-models.html#llsr-model-output"><i class="fa fa-check"></i><b>3.2.3</b> LLSR Model Output</a></li>
<li class="chapter" data-level="3.2.4" data-path="multilevel-models.html"><a href="multilevel-models.html#random-vs.-fixed-effects"><i class="fa fa-check"></i><b>3.2.4</b> Random vs. Fixed Effects</a></li>
<li class="chapter" data-level="3.2.5" data-path="multilevel-models.html"><a href="multilevel-models.html#an-initial-linear-mixed-effect-model"><i class="fa fa-check"></i><b>3.2.5</b> An Initial Linear Mixed Effect Model</a></li>
<li class="chapter" data-level="3.2.6" data-path="multilevel-models.html"><a href="multilevel-models.html#initial-mixed-effects-model-in-r"><i class="fa fa-check"></i><b>3.2.6</b> Initial Mixed Effects Model in R</a></li>
<li class="chapter" data-level="3.2.7" data-path="multilevel-models.html"><a href="multilevel-models.html#mixed-effects-model-interpretations"><i class="fa fa-check"></i><b>3.2.7</b> Mixed Effects Model Interpretations</a></li>
<li class="chapter" data-level="3.2.8" data-path="multilevel-models.html"><a href="multilevel-models.html#mixed-effects-model-without-interaction"><i class="fa fa-check"></i><b>3.2.8</b> Mixed Effects Model Without Interaction</a></li>
<li class="chapter" data-level="3.2.9" data-path="multilevel-models.html"><a href="multilevel-models.html#interpretations-for-model-without-interaction"><i class="fa fa-check"></i><b>3.2.9</b> Interpretations for Model without Interaction</a></li>
<li class="chapter" data-level="3.2.10" data-path="multilevel-models.html"><a href="multilevel-models.html#assumptions-in-first-mixed-effects-model"><i class="fa fa-check"></i><b>3.2.10</b> Assumptions in First Mixed Effects Model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multilevel-models.html"><a href="multilevel-models.html#random-slopes-model"><i class="fa fa-check"></i><b>3.3</b> Random Slopes Model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="multilevel-models.html"><a href="multilevel-models.html#differences-in-large-vs-smallsolo"><i class="fa fa-check"></i><b>3.3.1</b> Differences in Large vs Small/Solo</a></li>
<li class="chapter" data-level="3.3.2" data-path="multilevel-models.html"><a href="multilevel-models.html#illustration-of-previous-model"><i class="fa fa-check"></i><b>3.3.2</b> Illustration of Previous Model</a></li>
<li class="chapter" data-level="3.3.3" data-path="multilevel-models.html"><a href="multilevel-models.html#illustration-of-new-random-slopes-model"><i class="fa fa-check"></i><b>3.3.3</b> Illustration of New (Random Slopes) Model</a></li>
<li class="chapter" data-level="3.3.4" data-path="multilevel-models.html"><a href="multilevel-models.html#random-slopes-model-1"><i class="fa fa-check"></i><b>3.3.4</b> Random Slopes Model</a></li>
<li class="chapter" data-level="3.3.5" data-path="multilevel-models.html"><a href="multilevel-models.html#specifying-distribution-of-random-effects"><i class="fa fa-check"></i><b>3.3.5</b> Specifying Distribution of Random Effects</a></li>
<li class="chapter" data-level="3.3.6" data-path="multilevel-models.html"><a href="multilevel-models.html#random-slopes-model-with-error-term-distributions"><i class="fa fa-check"></i><b>3.3.6</b> Random Slopes Model with Error Term Distributions</a></li>
<li class="chapter" data-level="3.3.7" data-path="multilevel-models.html"><a href="multilevel-models.html#random-slopes-model-in-r"><i class="fa fa-check"></i><b>3.3.7</b> Random Slopes Model in R</a></li>
<li class="chapter" data-level="3.3.8" data-path="multilevel-models.html"><a href="multilevel-models.html#more-on-interpreting-parameters"><i class="fa fa-check"></i><b>3.3.8</b> More on Interpreting Parameters</a></li>
<li class="chapter" data-level="3.3.9" data-path="multilevel-models.html"><a href="multilevel-models.html#model-comparisons"><i class="fa fa-check"></i><b>3.3.9</b> Model Comparisons</a></li>
<li class="chapter" data-level="3.3.10" data-path="multilevel-models.html"><a href="multilevel-models.html#random-slopes-model-with-interaction"><i class="fa fa-check"></i><b>3.3.10</b> Random Slopes Model with Interaction</a></li>
<li class="chapter" data-level="3.3.11" data-path="multilevel-models.html"><a href="multilevel-models.html#random-slopes-model-with-interaction-in-r"><i class="fa fa-check"></i><b>3.3.11</b> Random Slopes Model with Interaction in R</a></li>
<li class="chapter" data-level="3.3.12" data-path="multilevel-models.html"><a href="multilevel-models.html#random-slope-vs-interaction-term"><i class="fa fa-check"></i><b>3.3.12</b> Random Slope vs Interaction Term</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="multilevel-models.html"><a href="multilevel-models.html#unconditional-means-model"><i class="fa fa-check"></i><b>3.4</b> Unconditional Means Model</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="multilevel-models.html"><a href="multilevel-models.html#unconditional-means-model-formulation"><i class="fa fa-check"></i><b>3.4.1</b> Unconditional Means Model Formulation</a></li>
<li class="chapter" data-level="3.4.2" data-path="multilevel-models.html"><a href="multilevel-models.html#unconditional-means-model-in-r"><i class="fa fa-check"></i><b>3.4.2</b> Unconditional Means Model in R</a></li>
<li class="chapter" data-level="3.4.3" data-path="multilevel-models.html"><a href="multilevel-models.html#unconditional-means-model-interpretations"><i class="fa fa-check"></i><b>3.4.3</b> Unconditional Means Model Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="multilevel-models.html"><a href="multilevel-models.html#building-a-multilevel-model"><i class="fa fa-check"></i><b>3.5</b> Building A Multilevel Model</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="multilevel-models.html"><a href="multilevel-models.html#centering-covariates"><i class="fa fa-check"></i><b>3.5.1</b> Centering Covariates</a></li>
<li class="chapter" data-level="3.5.2" data-path="multilevel-models.html"><a href="multilevel-models.html#a-possible-final-model"><i class="fa fa-check"></i><b>3.5.2</b> A Possible Final Model</a></li>
<li class="chapter" data-level="3.5.3" data-path="multilevel-models.html"><a href="multilevel-models.html#more-data-wrangling-1"><i class="fa fa-check"></i><b>3.5.3</b> More Data Wrangling</a></li>
<li class="chapter" data-level="3.5.4" data-path="multilevel-models.html"><a href="multilevel-models.html#fitting-model-a"><i class="fa fa-check"></i><b>3.5.4</b> Fitting Model A</a></li>
<li class="chapter" data-level="3.5.5" data-path="multilevel-models.html"><a href="multilevel-models.html#a-model-without-random-slopes"><i class="fa fa-check"></i><b>3.5.5</b> A Model Without Random Slopes</a></li>
<li class="chapter" data-level="3.5.6" data-path="multilevel-models.html"><a href="multilevel-models.html#fitting-model-b-in-r"><i class="fa fa-check"></i><b>3.5.6</b> Fitting Model B in R</a></li>
<li class="chapter" data-level="3.5.7" data-path="multilevel-models.html"><a href="multilevel-models.html#one-more-possible-model"><i class="fa fa-check"></i><b>3.5.7</b> One More Possible Model</a></li>
<li class="chapter" data-level="3.5.8" data-path="multilevel-models.html"><a href="multilevel-models.html#aic-and-bic-comparisons-for-models-b-and-c"><i class="fa fa-check"></i><b>3.5.8</b> AIC and BIC Comparisons for Models B and C</a></li>
<li class="chapter" data-level="3.5.9" data-path="multilevel-models.html"><a href="multilevel-models.html#likelihood-ratio-test"><i class="fa fa-check"></i><b>3.5.9</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="3.5.10" data-path="multilevel-models.html"><a href="multilevel-models.html#final-conclusions"><i class="fa fa-check"></i><b>3.5.10</b> Final Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="multilevel-models.html"><a href="multilevel-models.html#conceptual-questions"><i class="fa fa-check"></i><b>3.6</b> Conceptual Questions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="longitudinal-data.html"><a href="longitudinal-data.html"><i class="fa fa-check"></i><b>4</b> Longitudinal Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="longitudinal-data.html"><a href="longitudinal-data.html#charter-schools-exploratory-analysis"><i class="fa fa-check"></i><b>4.1</b> Charter Schools Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="longitudinal-data.html"><a href="longitudinal-data.html#data"><i class="fa fa-check"></i><b>4.1.1</b> Data Organization</a></li>
<li class="chapter" data-level="4.1.2" data-path="longitudinal-data.html"><a href="longitudinal-data.html#missing-data"><i class="fa fa-check"></i><b>4.1.2</b> Missing Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="longitudinal-data.html"><a href="longitudinal-data.html#convert-to-tidy-form"><i class="fa fa-check"></i><b>4.1.3</b> Convert to Tidy Form</a></li>
<li class="chapter" data-level="4.1.4" data-path="longitudinal-data.html"><a href="longitudinal-data.html#exploratory-analyses-for-general-multilevel-models"><i class="fa fa-check"></i><b>4.1.4</b> Exploratory Analyses for General Multilevel Models</a></li>
<li class="chapter" data-level="4.1.5" data-path="longitudinal-data.html"><a href="longitudinal-data.html#exploratory-analyses-for-longitudinal-data"><i class="fa fa-check"></i><b>4.1.5</b> Exploratory Analyses for Longitudinal Data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="longitudinal-data.html"><a href="longitudinal-data.html#multilevel-longitudinal-models"><i class="fa fa-check"></i><b>4.2</b> Multilevel Longitudinal Models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="longitudinal-data.html"><a href="longitudinal-data.html#unconditional-means-model-1"><i class="fa fa-check"></i><b>4.2.1</b> Unconditional Means Model</a></li>
<li class="chapter" data-level="4.2.2" data-path="longitudinal-data.html"><a href="longitudinal-data.html#interpretations-in-unconditional-means-model"><i class="fa fa-check"></i><b>4.2.2</b> Interpretations in Unconditional Means Model</a></li>
<li class="chapter" data-level="4.2.3" data-path="longitudinal-data.html"><a href="longitudinal-data.html#intraclass-correlation-coefficient"><i class="fa fa-check"></i><b>4.2.3</b> Intraclass Correlation Coefficient:</a></li>
<li class="chapter" data-level="4.2.4" data-path="longitudinal-data.html"><a href="longitudinal-data.html#unconditional-growth-model"><i class="fa fa-check"></i><b>4.2.4</b> Unconditional Growth Model</a></li>
<li class="chapter" data-level="4.2.5" data-path="longitudinal-data.html"><a href="longitudinal-data.html#interpretations-in-unconditional-growth-model"><i class="fa fa-check"></i><b>4.2.5</b> Interpretations in Unconditional Growth Model</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="longitudinal-data.html"><a href="longitudinal-data.html#quadratic-and-piecewise-linear-models"><i class="fa fa-check"></i><b>4.3</b> Quadratic and Piecewise Linear Models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="longitudinal-data.html"><a href="longitudinal-data.html#quadratic-trend-over-time"><i class="fa fa-check"></i><b>4.3.1</b> Quadratic Trend over Time</a></li>
<li class="chapter" data-level="4.3.2" data-path="longitudinal-data.html"><a href="longitudinal-data.html#quadratic-model"><i class="fa fa-check"></i><b>4.3.2</b> Quadratic Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="longitudinal-data.html"><a href="longitudinal-data.html#quadratic-model-in-r-1"><i class="fa fa-check"></i><b>4.3.3</b> Quadratic Model in R</a></li>
<li class="chapter" data-level="4.3.4" data-path="longitudinal-data.html"><a href="longitudinal-data.html#estimated-response-curve"><i class="fa fa-check"></i><b>4.3.4</b> Estimated Response Curve</a></li>
<li class="chapter" data-level="4.3.5" data-path="longitudinal-data.html"><a href="longitudinal-data.html#linear-and-quadratic-error-terms"><i class="fa fa-check"></i><b>4.3.5</b> Linear and Quadratic Error Terms</a></li>
<li class="chapter" data-level="4.3.6" data-path="longitudinal-data.html"><a href="longitudinal-data.html#model-with-many-random-terms-in-r"><i class="fa fa-check"></i><b>4.3.6</b> Model with Many Random Terms in R</a></li>
<li class="chapter" data-level="4.3.7" data-path="longitudinal-data.html"><a href="longitudinal-data.html#only-a-linear-random-term"><i class="fa fa-check"></i><b>4.3.7</b> Only a Linear Random Term</a></li>
<li class="chapter" data-level="4.3.8" data-path="longitudinal-data.html"><a href="longitudinal-data.html#comments-on-random-terms"><i class="fa fa-check"></i><b>4.3.8</b> Comments on Random Terms</a></li>
<li class="chapter" data-level="4.3.9" data-path="longitudinal-data.html"><a href="longitudinal-data.html#model-comparison"><i class="fa fa-check"></i><b>4.3.9</b> Model Comparison</a></li>
<li class="chapter" data-level="4.3.10" data-path="longitudinal-data.html"><a href="longitudinal-data.html#piecewise-linear-model"><i class="fa fa-check"></i><b>4.3.10</b> Piecewise Linear Model</a></li>
<li class="chapter" data-level="4.3.11" data-path="longitudinal-data.html"><a href="longitudinal-data.html#piecewise-model-equation"><i class="fa fa-check"></i><b>4.3.11</b> Piecewise Model Equation</a></li>
<li class="chapter" data-level="4.3.12" data-path="longitudinal-data.html"><a href="longitudinal-data.html#estimated-response-curve-1"><i class="fa fa-check"></i><b>4.3.12</b> Estimated Response Curve</a></li>
<li class="chapter" data-level="4.3.13" data-path="longitudinal-data.html"><a href="longitudinal-data.html#comparing-quadratic-and-piecewise-models"><i class="fa fa-check"></i><b>4.3.13</b> Comparing Quadratic and Piecewise Models</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="longitudinal-data.html"><a href="longitudinal-data.html#model-for-school-type"><i class="fa fa-check"></i><b>4.4</b> Model for School Type</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="longitudinal-data.html"><a href="longitudinal-data.html#uncontrolled-effects-of-school-type"><i class="fa fa-check"></i><b>4.4.1</b> Uncontrolled Effects of School Type</a></li>
<li class="chapter" data-level="4.4.2" data-path="longitudinal-data.html"><a href="longitudinal-data.html#interpretations-for-school-type-model"><i class="fa fa-check"></i><b>4.4.2</b> Interpretations for School Type Model</a></li>
<li class="chapter" data-level="4.4.3" data-path="longitudinal-data.html"><a href="longitudinal-data.html#illustration"><i class="fa fa-check"></i><b>4.4.3</b> Illustration</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="longitudinal-data.html"><a href="longitudinal-data.html#covariance-structure-among-observations"><i class="fa fa-check"></i><b>4.5</b> Covariance Structure among Observations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="longitudinal-data.html"><a href="longitudinal-data.html#standard-covariance-structure"><i class="fa fa-check"></i><b>4.5.1</b> Standard Covariance Structure</a></li>
<li class="chapter" data-level="4.5.2" data-path="longitudinal-data.html"><a href="longitudinal-data.html#derivation-of-vary_i1-optional"><i class="fa fa-check"></i><b>4.5.2</b> Derivation of <span class="math inline">\(Var(Y_{i1})\)</span> (optional)</a></li>
<li class="chapter" data-level="4.5.3" data-path="longitudinal-data.html"><a href="longitudinal-data.html#interpretations-of-vary_i1-and-covy_ij-y_ik"><i class="fa fa-check"></i><b>4.5.3</b> Interpretations of <span class="math inline">\(Var(Y_{i1})\)</span> and <span class="math inline">\(Cov(Y_{ij}, Y_{ik})\)</span></a></li>
<li class="chapter" data-level="4.5.4" data-path="longitudinal-data.html"><a href="longitudinal-data.html#variance-and-covariance-estimates"><i class="fa fa-check"></i><b>4.5.4</b> Variance and Covariance Estimates</a></li>
<li class="chapter" data-level="4.5.5" data-path="longitudinal-data.html"><a href="longitudinal-data.html#alternative-covariance-structure---uncorrelated"><i class="fa fa-check"></i><b>4.5.5</b> Alternative Covariance Structure - Uncorrelated</a></li>
<li class="chapter" data-level="4.5.6" data-path="longitudinal-data.html"><a href="longitudinal-data.html#alternative-covariance-structure---unstructured"><i class="fa fa-check"></i><b>4.5.6</b> Alternative Covariance Structure - Unstructured</a></li>
<li class="chapter" data-level="4.5.7" data-path="longitudinal-data.html"><a href="longitudinal-data.html#alternative-covariance-structure---compound-symmetry"><i class="fa fa-check"></i><b>4.5.7</b> Alternative Covariance Structure - Compound Symmetry</a></li>
<li class="chapter" data-level="4.5.8" data-path="longitudinal-data.html"><a href="longitudinal-data.html#alternative-covariance-structure---autogregressive"><i class="fa fa-check"></i><b>4.5.8</b> Alternative Covariance Structure - Autogregressive</a></li>
<li class="chapter" data-level="4.5.9" data-path="longitudinal-data.html"><a href="longitudinal-data.html#ar1-model-on-schools-data"><i class="fa fa-check"></i><b>4.5.9</b> AR(1) Model on Schools Data</a></li>
<li class="chapter" data-level="4.5.10" data-path="longitudinal-data.html"><a href="longitudinal-data.html#non-longitudinal-multilevel-models"><i class="fa fa-check"></i><b>4.5.10</b> Non-longitudinal Multilevel Models</a></li>
<li class="chapter" data-level="4.5.11" data-path="longitudinal-data.html"><a href="longitudinal-data.html#final-thoughts-regarding-covariance-structures"><i class="fa fa-check"></i><b>4.5.11</b> Final Thoughts Regarding Covariance Structures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html"><i class="fa fa-check"></i><b>5</b> Data with Three or More Levels</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#three-level-plants-experiment"><i class="fa fa-check"></i><b>5.1</b> Three-Level Plants Experiment</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#experimental-design"><i class="fa fa-check"></i><b>5.1.1</b> Experimental Design</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#the-data-1"><i class="fa fa-check"></i><b>5.1.2</b> The Data</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#questions"><i class="fa fa-check"></i><b>5.1.3</b> Questions</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#three-level-model"><i class="fa fa-check"></i><b>5.1.4</b> Three Level Model</a></li>
<li class="chapter" data-level="5.1.5" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#r-implementation-of-three-level-model"><i class="fa fa-check"></i><b>5.1.5</b> R Implementation of Three Level Model</a></li>
<li class="chapter" data-level="5.1.6" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#inappropriate-llsr-model"><i class="fa fa-check"></i><b>5.1.6</b> Inappropriate LLSR Model</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#three-level-model-with-random-slopes"><i class="fa fa-check"></i><b>5.2</b> Three-Level Model with Random Slopes</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#random-slope-for-phenoa"><i class="fa fa-check"></i><b>5.2.1</b> Random Slope for PhenoA</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#r-output-for-random-slope-for-phenoa"><i class="fa fa-check"></i><b>5.2.2</b> R Output for Random Slope for PhenoA</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#random-slope-for-fert"><i class="fa fa-check"></i><b>5.2.3</b> Random Slope for Fert</a></li>
<li class="chapter" data-level="5.2.4" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#r-output-for-random-slope-for-fert"><i class="fa fa-check"></i><b>5.2.4</b> R Output for Random Slope for Fert</a></li>
<li class="chapter" data-level="5.2.5" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#boundary-constraints"><i class="fa fa-check"></i><b>5.2.5</b> Boundary Constraints</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#longitudinal-component-to-plants-data"><i class="fa fa-check"></i><b>5.3</b> Longitudinal Component to Plants Data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#repeated-measures-over-time"><i class="fa fa-check"></i><b>5.3.1</b> Repeated Measures over Time</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#levels-and-variables"><i class="fa fa-check"></i><b>5.3.2</b> Levels and Variables</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#model-for-longitudinal-plants-study"><i class="fa fa-check"></i><b>5.3.3</b> Model for Longitudinal Plants Study</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#r-output-for-longitudinal-model"><i class="fa fa-check"></i><b>5.3.4</b> R Output for Longitudinal Model</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#four-level-longitudinal-model-with-random-slopes"><i class="fa fa-check"></i><b>5.4</b> Four-Level Longitudinal Model with Random Slopes</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#random-slope-for-time"><i class="fa fa-check"></i><b>5.4.1</b> Random Slope for Time</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#more-random-slope-terms"><i class="fa fa-check"></i><b>5.4.2</b> More Random Slope Terms</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#additional-random-slopes"><i class="fa fa-check"></i><b>5.4.3</b> Additional Random Slopes</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#r---model-with-additional-random-slopes"><i class="fa fa-check"></i><b>5.4.4</b> R - Model with Additional Random Slopes</a></li>
<li class="chapter" data-level="5.4.5" data-path="data-with-three-or-more-levels.html"><a href="data-with-three-or-more-levels.html#when-not-to-add-random-slopes"><i class="fa fa-check"></i><b>5.4.5</b> When Not to Add Random Slopes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>6</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="poisson-regression.html"><a href="poisson-regression.html#modeling-counts"><i class="fa fa-check"></i><b>6.1</b> Modeling Counts</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="poisson-regression.html"><a href="poisson-regression.html#case-study-household-size-in-the-philippines"><i class="fa fa-check"></i><b>6.1.1</b> Case Study: Household Size in the Philippines</a></li>
<li class="chapter" data-level="6.1.2" data-path="poisson-regression.html"><a href="poisson-regression.html#map-of-the-philippines"><i class="fa fa-check"></i><b>6.1.2</b> Map of the Philippines</a></li>
<li class="chapter" data-level="6.1.3" data-path="poisson-regression.html"><a href="poisson-regression.html#questions-of-interest-2"><i class="fa fa-check"></i><b>6.1.3</b> Questions of Interest</a></li>
<li class="chapter" data-level="6.1.4" data-path="poisson-regression.html"><a href="poisson-regression.html#the-data-2"><i class="fa fa-check"></i><b>6.1.4</b> The Data</a></li>
<li class="chapter" data-level="6.1.5" data-path="poisson-regression.html"><a href="poisson-regression.html#first-5-rows"><i class="fa fa-check"></i><b>6.1.5</b> First 5 Rows</a></li>
<li class="chapter" data-level="6.1.6" data-path="poisson-regression.html"><a href="poisson-regression.html#household-size-by-region"><i class="fa fa-check"></i><b>6.1.6</b> Household Size by Region</a></li>
<li class="chapter" data-level="6.1.7" data-path="poisson-regression.html"><a href="poisson-regression.html#household-size-by-region-plots"><i class="fa fa-check"></i><b>6.1.7</b> Household Size by Region Plots</a></li>
<li class="chapter" data-level="6.1.8" data-path="poisson-regression.html"><a href="poisson-regression.html#modeling-household-size"><i class="fa fa-check"></i><b>6.1.8</b> Modeling Household Size</a></li>
<li class="chapter" data-level="6.1.9" data-path="poisson-regression.html"><a href="poisson-regression.html#inappropriate-llsr-model-1"><i class="fa fa-check"></i><b>6.1.9</b> Inappropriate LLSR Model</a></li>
<li class="chapter" data-level="6.1.10" data-path="poisson-regression.html"><a href="poisson-regression.html#llsr-model-r-output"><i class="fa fa-check"></i><b>6.1.10</b> LLSR Model R Output</a></li>
<li class="chapter" data-level="6.1.11" data-path="poisson-regression.html"><a href="poisson-regression.html#llsr-assumptions"><i class="fa fa-check"></i><b>6.1.11</b> LLSR Assumptions</a></li>
<li class="chapter" data-level="6.1.12" data-path="poisson-regression.html"><a href="poisson-regression.html#distribution-in-visayas-region"><i class="fa fa-check"></i><b>6.1.12</b> Distribution in Visayas Region</a></li>
<li class="chapter" data-level="6.1.13" data-path="poisson-regression.html"><a href="poisson-regression.html#normal-quantile-quantile-plot"><i class="fa fa-check"></i><b>6.1.13</b> Normal Quantile Quantile Plot</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-regression-models"><i class="fa fa-check"></i><b>6.2</b> Poisson Regression Models</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="poisson-regression.html"><a href="poisson-regression.html#the-poisson-distribution"><i class="fa fa-check"></i><b>6.2.1</b> The Poisson Distribution</a></li>
<li class="chapter" data-level="6.2.2" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-distribution-for-lambda1"><i class="fa fa-check"></i><b>6.2.2</b> Poisson Distribution for <span class="math inline">\(\lambda=1\)</span></a></li>
<li class="chapter" data-level="6.2.3" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-distribution-for-lambdain135"><i class="fa fa-check"></i><b>6.2.3</b> Poisson Distribution for <span class="math inline">\(\lambda\in\{1,3,5\}\)</span></a></li>
<li class="chapter" data-level="6.2.4" data-path="poisson-regression.html"><a href="poisson-regression.html#connecting-expected-response-to-explatory-variables"><i class="fa fa-check"></i><b>6.2.4</b> Connecting Expected Response to Explatory Variables</a></li>
<li class="chapter" data-level="6.2.5" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-regression-assumptions"><i class="fa fa-check"></i><b>6.2.5</b> Poisson Regression Assumptions</a></li>
<li class="chapter" data-level="6.2.6" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-regression-illustration"><i class="fa fa-check"></i><b>6.2.6</b> Poisson Regression Illustration</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-model-for-household-size"><i class="fa fa-check"></i><b>6.3</b> Poisson Model for Household Size</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-regression-model-for-location"><i class="fa fa-check"></i><b>6.3.1</b> Poisson Regression Model for Location</a></li>
<li class="chapter" data-level="6.3.2" data-path="poisson-regression.html"><a href="poisson-regression.html#interpreting-model-parameters-in-poisson-regression"><i class="fa fa-check"></i><b>6.3.2</b> Interpreting Model Parameters in Poisson Regression</a></li>
<li class="chapter" data-level="6.3.3" data-path="poisson-regression.html"><a href="poisson-regression.html#wald-based-confidence-intervals-for-difference"><i class="fa fa-check"></i><b>6.3.3</b> Wald-Based Confidence Intervals for Difference</a></li>
<li class="chapter" data-level="6.3.4" data-path="poisson-regression.html"><a href="poisson-regression.html#mean-variance-assumption"><i class="fa fa-check"></i><b>6.3.4</b> Mean = Variance Assumption</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-model-with-multiple-explanatory-variables"><i class="fa fa-check"></i><b>6.4</b> Poisson Model with Multiple Explanatory Variables</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="poisson-regression.html"><a href="poisson-regression.html#accounting-for-age-of-head-of-household"><i class="fa fa-check"></i><b>6.4.1</b> Accounting for Age of Head of Household</a></li>
<li class="chapter" data-level="6.4.2" data-path="poisson-regression.html"><a href="poisson-regression.html#r-output-for-model-with-age"><i class="fa fa-check"></i><b>6.4.2</b> R Output for Model with Age</a></li>
<li class="chapter" data-level="6.4.3" data-path="poisson-regression.html"><a href="poisson-regression.html#interpreting-coefficients-for-numeric-explanatory-variable"><i class="fa fa-check"></i><b>6.4.3</b> Interpreting Coefficients for Numeric Explanatory Variable</a></li>
<li class="chapter" data-level="6.4.4" data-path="poisson-regression.html"><a href="poisson-regression.html#mean-variance-assumption-1"><i class="fa fa-check"></i><b>6.4.4</b> Mean = Variance Assumption</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="poisson-regression.html"><a href="poisson-regression.html#deviance-and-model-comparison"><i class="fa fa-check"></i><b>6.5</b> Deviance and Model Comparison</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="poisson-regression.html"><a href="poisson-regression.html#accounting-for-nonlinear-trend"><i class="fa fa-check"></i><b>6.5.1</b> Accounting for Nonlinear Trend</a></li>
<li class="chapter" data-level="6.5.2" data-path="poisson-regression.html"><a href="poisson-regression.html#quadratic-poisson-regresson-model"><i class="fa fa-check"></i><b>6.5.2</b> Quadratic Poisson Regresson Model</a></li>
<li class="chapter" data-level="6.5.3" data-path="poisson-regression.html"><a href="poisson-regression.html#residuals-for-poisson-models"><i class="fa fa-check"></i><b>6.5.3</b> Residuals for Poisson Models</a></li>
<li class="chapter" data-level="6.5.4" data-path="poisson-regression.html"><a href="poisson-regression.html#plot-of-deviance-residuals-for-first-order-poisson-model"><i class="fa fa-check"></i><b>6.5.4</b> Plot of Deviance Residuals for First-Order Poisson Model</a></li>
<li class="chapter" data-level="6.5.5" data-path="poisson-regression.html"><a href="poisson-regression.html#plot-of-deviance-residuals-for-quadratic-poisson-model"><i class="fa fa-check"></i><b>6.5.5</b> Plot of Deviance Residuals for Quadratic Poisson Model</a></li>
<li class="chapter" data-level="6.5.6" data-path="poisson-regression.html"><a href="poisson-regression.html#residual-deviance-for-a-model"><i class="fa fa-check"></i><b>6.5.6</b> Residual Deviance for a Model</a></li>
<li class="chapter" data-level="6.5.7" data-path="poisson-regression.html"><a href="poisson-regression.html#drop-in-deviance-test"><i class="fa fa-check"></i><b>6.5.7</b> Drop-in-Deviance Test</a></li>
<li class="chapter" data-level="6.5.8" data-path="poisson-regression.html"><a href="poisson-regression.html#drop-in-deviance-test-1"><i class="fa fa-check"></i><b>6.5.8</b> Drop-in-Deviance Test</a></li>
<li class="chapter" data-level="6.5.9" data-path="poisson-regression.html"><a href="poisson-regression.html#visual-of-chi2-test"><i class="fa fa-check"></i><b>6.5.9</b> Visual of <span class="math inline">\(\chi^2\)</span> Test</a></li>
<li class="chapter" data-level="6.5.10" data-path="poisson-regression.html"><a href="poisson-regression.html#adding-roofing-material-to-model"><i class="fa fa-check"></i><b>6.5.10</b> Adding Roofing Material to Model</a></li>
<li class="chapter" data-level="6.5.11" data-path="poisson-regression.html"><a href="poisson-regression.html#visual-of-chi2-test-for-roof"><i class="fa fa-check"></i><b>6.5.11</b> Visual of <span class="math inline">\(\chi^2\)</span> Test for Roof</a></li>
<li class="chapter" data-level="6.5.12" data-path="poisson-regression.html"><a href="poisson-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>6.5.12</b> Goodness-of-Fit</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="poisson-regression.html"><a href="poisson-regression.html#overdisperson"><i class="fa fa-check"></i><b>6.6</b> Overdisperson</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="poisson-regression.html"><a href="poisson-regression.html#quasi-poisson-model"><i class="fa fa-check"></i><b>6.6.1</b> Quasi-Poisson Model</a></li>
<li class="chapter" data-level="6.6.2" data-path="poisson-regression.html"><a href="poisson-regression.html#quasi-poisson-model-in-r"><i class="fa fa-check"></i><b>6.6.2</b> Quasi-Poisson Model in R</a></li>
<li class="chapter" data-level="6.6.3" data-path="poisson-regression.html"><a href="poisson-regression.html#standard-errors-in-quasi-poisson-model"><i class="fa fa-check"></i><b>6.6.3</b> Standard Errors in Quasi-Poisson Model</a></li>
<li class="chapter" data-level="6.6.4" data-path="poisson-regression.html"><a href="poisson-regression.html#drop-in-deviance-tests-for-quasi-poisson-model"><i class="fa fa-check"></i><b>6.6.4</b> Drop-in-Deviance Tests for Quasi-Poisson Model</a></li>
<li class="chapter" data-level="6.6.5" data-path="poisson-regression.html"><a href="poisson-regression.html#first-vs-second-order-quasi-poisson-models"><i class="fa fa-check"></i><b>6.6.5</b> First vs Second Order Quasi-Poisson Models</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="poisson-regression.html"><a href="poisson-regression.html#offsets-in-poisson-regression"><i class="fa fa-check"></i><b>6.7</b> Offsets in Poisson Regression</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="poisson-regression.html"><a href="poisson-regression.html#case-study-campus-crime"><i class="fa fa-check"></i><b>6.7.1</b> Case Study: Campus Crime</a></li>
<li class="chapter" data-level="6.7.2" data-path="poisson-regression.html"><a href="poisson-regression.html#distribution-of-number-of-crimes"><i class="fa fa-check"></i><b>6.7.2</b> Distribution of Number of Crimes</a></li>
<li class="chapter" data-level="6.7.3" data-path="poisson-regression.html"><a href="poisson-regression.html#crimes-by-type-of-institution-and-region"><i class="fa fa-check"></i><b>6.7.3</b> Crimes by Type of Institution and Region</a></li>
<li class="chapter" data-level="6.7.4" data-path="poisson-regression.html"><a href="poisson-regression.html#accounting-for-enrollment"><i class="fa fa-check"></i><b>6.7.4</b> Accounting for Enrollment</a></li>
<li class="chapter" data-level="6.7.5" data-path="poisson-regression.html"><a href="poisson-regression.html#offset-in-r"><i class="fa fa-check"></i><b>6.7.5</b> Offset in R</a></li>
<li class="chapter" data-level="6.7.6" data-path="poisson-regression.html"><a href="poisson-regression.html#model-with-interaction"><i class="fa fa-check"></i><b>6.7.6</b> Model with Interaction</a></li>
<li class="chapter" data-level="6.7.7" data-path="poisson-regression.html"><a href="poisson-regression.html#drop-in-deviance-test-for-interaction"><i class="fa fa-check"></i><b>6.7.7</b> Drop-in-Deviance Test for Interaction</a></li>
<li class="chapter" data-level="6.7.8" data-path="poisson-regression.html"><a href="poisson-regression.html#goodness-of-fit-test"><i class="fa fa-check"></i><b>6.7.8</b> Goodness of Fit Test</a></li>
<li class="chapter" data-level="6.7.9" data-path="poisson-regression.html"><a href="poisson-regression.html#quasi-poisson-model-1"><i class="fa fa-check"></i><b>6.7.9</b> Quasi-Poisson Model</a></li>
<li class="chapter" data-level="6.7.10" data-path="poisson-regression.html"><a href="poisson-regression.html#test-for-interaction"><i class="fa fa-check"></i><b>6.7.10</b> Test for Interaction</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="poisson-regression.html"><a href="poisson-regression.html#summaries"><i class="fa fa-check"></i><b>6.8</b> Summaries</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="poisson-regression.html"><a href="poisson-regression.html#llsr-vs.-poisson-regression-comparison"><i class="fa fa-check"></i><b>6.8.1</b> LLSR vs. Poisson Regression Comparison</a></li>
<li class="chapter" data-level="6.8.2" data-path="poisson-regression.html"><a href="poisson-regression.html#poisson-vs-quasi-poisson-inference"><i class="fa fa-check"></i><b>6.8.2</b> Poisson vs Quasi-Poisson Inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>7</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression.html"><a href="logistic-regression.html#binomial-logistic-regression"><i class="fa fa-check"></i><b>7.1</b> Binomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#binary-response-data"><i class="fa fa-check"></i><b>7.1.1</b> Binary Response Data</a></li>
<li class="chapter" data-level="7.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#binomial-response-data"><i class="fa fa-check"></i><b>7.1.2</b> Binomial Response Data</a></li>
<li class="chapter" data-level="7.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#wisconsin-election-data"><i class="fa fa-check"></i><b>7.1.3</b> 2020 Wisconsin Election Data</a></li>
<li class="chapter" data-level="7.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#correlation-between-explanatory-variables"><i class="fa fa-check"></i><b>7.1.4</b> Correlation Between Explanatory Variables</a></li>
<li class="chapter" data-level="7.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#modeling-number-of-votes"><i class="fa fa-check"></i><b>7.1.5</b> Modeling Number of Votes</a></li>
<li class="chapter" data-level="7.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#the-binomial-distribution"><i class="fa fa-check"></i><b>7.1.6</b> The Binomial Distribution</a></li>
<li class="chapter" data-level="7.1.7" data-path="logistic-regression.html"><a href="logistic-regression.html#binomial-distribution-for-n4-p0.6"><i class="fa fa-check"></i><b>7.1.7</b> Binomial Distribution for <span class="math inline">\(n=4, p=0.6\)</span></a></li>
<li class="chapter" data-level="7.1.8" data-path="logistic-regression.html"><a href="logistic-regression.html#more-binomial-distributions"><i class="fa fa-check"></i><b>7.1.8</b> More Binomial Distributions</a></li>
<li class="chapter" data-level="7.1.9" data-path="logistic-regression.html"><a href="logistic-regression.html#connecting-expected-response-to-explatory-variables-1"><i class="fa fa-check"></i><b>7.1.9</b> Connecting Expected Response to Explatory Variables</a></li>
<li class="chapter" data-level="7.1.10" data-path="logistic-regression.html"><a href="logistic-regression.html#odds-and-odds-ratio"><i class="fa fa-check"></i><b>7.1.10</b> Odds and Odds Ratio</a></li>
<li class="chapter" data-level="7.1.11" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-regression-coefficients"><i class="fa fa-check"></i><b>7.1.11</b> Interpreting Regression Coefficients</a></li>
<li class="chapter" data-level="7.1.12" data-path="logistic-regression.html"><a href="logistic-regression.html#binomial-logistic-regression-assumptions"><i class="fa fa-check"></i><b>7.1.12</b> Binomial Logistic Regression Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="logistic-regression.html"><a href="logistic-regression.html#model-for-wisconsin-vote"><i class="fa fa-check"></i><b>7.2</b> Model for Wisconsin Vote</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#an-initial-model"><i class="fa fa-check"></i><b>7.2.1</b> An Initial Model</a></li>
<li class="chapter" data-level="7.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#checking-linearity-assumption"><i class="fa fa-check"></i><b>7.2.2</b> Checking Linearity Assumption</a></li>
<li class="chapter" data-level="7.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#overdispersion-in-binomial-counts"><i class="fa fa-check"></i><b>7.2.3</b> Overdispersion in Binomial Counts</a></li>
<li class="chapter" data-level="7.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#residuals-for-binomial-logistic-regression"><i class="fa fa-check"></i><b>7.2.4</b> Residuals for Binomial Logistic Regression</a></li>
<li class="chapter" data-level="7.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#quasi-binomial-model"><i class="fa fa-check"></i><b>7.2.5</b> Quasi-Binomial Model</a></li>
<li class="chapter" data-level="7.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#model-with-all-explanatory-variables"><i class="fa fa-check"></i><b>7.2.6</b> Model with All Explanatory Variables</a></li>
<li class="chapter" data-level="7.2.7" data-path="logistic-regression.html"><a href="logistic-regression.html#tests-for-significance-of-model-coefficients"><i class="fa fa-check"></i><b>7.2.7</b> Tests for Significance of Model Coefficients</a></li>
<li class="chapter" data-level="7.2.8" data-path="logistic-regression.html"><a href="logistic-regression.html#drop-in-deviance-test-2"><i class="fa fa-check"></i><b>7.2.8</b> Drop in Deviance Test</a></li>
<li class="chapter" data-level="7.2.9" data-path="logistic-regression.html"><a href="logistic-regression.html#deviance-residual-plot"><i class="fa fa-check"></i><b>7.2.9</b> Deviance Residual Plot</a></li>
<li class="chapter" data-level="7.2.10" data-path="logistic-regression.html"><a href="logistic-regression.html#llsr-vs-binomial-logistic-regression"><i class="fa fa-check"></i><b>7.2.10</b> LLSR vs Binomial Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>7.3</b> Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#parameter-estimation"><i class="fa fa-check"></i><b>7.3.1</b> Parameter Estimation</a></li>
<li class="chapter" data-level="7.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#steph-curry-3-point-shooting"><i class="fa fa-check"></i><b>7.3.2</b> Steph Curry 3-Point Shooting</a></li>
<li class="chapter" data-level="7.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#model-for-currys-shooting"><i class="fa fa-check"></i><b>7.3.3</b> Model for Curry’s Shooting</a></li>
<li class="chapter" data-level="7.3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#likelihood-function"><i class="fa fa-check"></i><b>7.3.4</b> Likelihood Function</a></li>
<li class="chapter" data-level="7.3.5" data-path="logistic-regression.html"><a href="logistic-regression.html#plotting-likelihood-function"><i class="fa fa-check"></i><b>7.3.5</b> Plotting Likelihood Function</a></li>
<li class="chapter" data-level="7.3.6" data-path="logistic-regression.html"><a href="logistic-regression.html#numerical-maximization"><i class="fa fa-check"></i><b>7.3.6</b> Numerical Maximization</a></li>
<li class="chapter" data-level="7.3.7" data-path="logistic-regression.html"><a href="logistic-regression.html#mle-using-calculus"><i class="fa fa-check"></i><b>7.3.7</b> MLE Using Calculus</a></li>
<li class="chapter" data-level="7.3.8" data-path="logistic-regression.html"><a href="logistic-regression.html#likelihood-in-a-logistic-regression-model"><i class="fa fa-check"></i><b>7.3.8</b> Likelihood in a Logistic Regression Model</a></li>
<li class="chapter" data-level="7.3.9" data-path="logistic-regression.html"><a href="logistic-regression.html#plot-of-likelihood-function"><i class="fa fa-check"></i><b>7.3.9</b> Plot of Likelihood Function</a></li>
<li class="chapter" data-level="7.3.10" data-path="logistic-regression.html"><a href="logistic-regression.html#numerical-maximization-1"><i class="fa fa-check"></i><b>7.3.10</b> Numerical Maximization</a></li>
<li class="chapter" data-level="7.3.11" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-to-r-output"><i class="fa fa-check"></i><b>7.3.11</b> Comparison to R Output</a></li>
<li class="chapter" data-level="7.3.12" data-path="logistic-regression.html"><a href="logistic-regression.html#model-for-homeaway"><i class="fa fa-check"></i><b>7.3.12</b> Model for Home/Away</a></li>
<li class="chapter" data-level="7.3.13" data-path="logistic-regression.html"><a href="logistic-regression.html#numerical-optimization"><i class="fa fa-check"></i><b>7.3.13</b> Numerical Optimization</a></li>
<li class="chapter" data-level="7.3.14" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-to-r-output-1"><i class="fa fa-check"></i><b>7.3.14</b> Comparison to R Output</a></li>
<li class="chapter" data-level="7.3.15" data-path="logistic-regression.html"><a href="logistic-regression.html#applications-of-likelihood"><i class="fa fa-check"></i><b>7.3.15</b> Applications of Likelihood</a></li>
<li class="chapter" data-level="7.3.16" data-path="logistic-regression.html"><a href="logistic-regression.html#summary-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>7.3.16</b> Summary Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="logistic-regression.html"><a href="logistic-regression.html#zero-inflated-poisson-model"><i class="fa fa-check"></i><b>7.4</b> Zero-Inflated Poisson Model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#case-study-weekend-drinking"><i class="fa fa-check"></i><b>7.4.1</b> Case Study: Weekend Drinking</a></li>
<li class="chapter" data-level="7.4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#questions-of-interest-3"><i class="fa fa-check"></i><b>7.4.2</b> Questions of Interest</a></li>
<li class="chapter" data-level="7.4.3" data-path="logistic-regression.html"><a href="logistic-regression.html#distribution-of-number-of-drinks"><i class="fa fa-check"></i><b>7.4.3</b> Distribution of Number of Drinks</a></li>
<li class="chapter" data-level="7.4.4" data-path="logistic-regression.html"><a href="logistic-regression.html#number-of-drinks-comparisons"><i class="fa fa-check"></i><b>7.4.4</b> Number of Drinks Comparisons</a></li>
<li class="chapter" data-level="7.4.5" data-path="logistic-regression.html"><a href="logistic-regression.html#proportion-of-drinkers"><i class="fa fa-check"></i><b>7.4.5</b> Proportion of Drinkers</a></li>
<li class="chapter" data-level="7.4.6" data-path="logistic-regression.html"><a href="logistic-regression.html#modeling-drinks"><i class="fa fa-check"></i><b>7.4.6</b> Modeling Drinks</a></li>
<li class="chapter" data-level="7.4.7" data-path="logistic-regression.html"><a href="logistic-regression.html#explaining-the-large-number-of-zeros"><i class="fa fa-check"></i><b>7.4.7</b> Explaining the Large Number of Zeros</a></li>
<li class="chapter" data-level="7.4.8" data-path="logistic-regression.html"><a href="logistic-regression.html#zero-inflated-poisson-model-1"><i class="fa fa-check"></i><b>7.4.8</b> Zero-Inflated Poisson Model</a></li>
<li class="chapter" data-level="7.4.9" data-path="logistic-regression.html"><a href="logistic-regression.html#developing-the-zero-inflated-poisson-model"><i class="fa fa-check"></i><b>7.4.9</b> Developing the Zero-Inflated Poisson Model</a></li>
<li class="chapter" data-level="7.4.10" data-path="logistic-regression.html"><a href="logistic-regression.html#deriving-the-zip-pmf"><i class="fa fa-check"></i><b>7.4.10</b> Deriving the ZIP PMF</a></li>
<li class="chapter" data-level="7.4.11" data-path="logistic-regression.html"><a href="logistic-regression.html#examples-of-zip-pmfs"><i class="fa fa-check"></i><b>7.4.11</b> Examples of ZIP PMF’s</a></li>
<li class="chapter" data-level="7.4.12" data-path="logistic-regression.html"><a href="logistic-regression.html#zip-model"><i class="fa fa-check"></i><b>7.4.12</b> ZIP Model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="logistic-regression.html"><a href="logistic-regression.html#model-for-drinks-data"><i class="fa fa-check"></i><b>7.5</b> Model for Drinks Data</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#zip-for-drinks-data"><i class="fa fa-check"></i><b>7.5.1</b> ZIP for Drinks Data</a></li>
<li class="chapter" data-level="7.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#zip-model-in-r"><i class="fa fa-check"></i><b>7.5.2</b> ZIP Model in R</a></li>
<li class="chapter" data-level="7.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#residual-plot"><i class="fa fa-check"></i><b>7.5.3</b> Residual Plot</a></li>
<li class="chapter" data-level="7.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#limitations"><i class="fa fa-check"></i><b>7.5.4</b> Limitations</a></li>
<li class="chapter" data-level="7.5.5" data-path="logistic-regression.html"><a href="logistic-regression.html#final-thoughts-on-zero-inflated-models"><i class="fa fa-check"></i><b>7.5.5</b> Final Thoughts on Zero-Inflated Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html"><i class="fa fa-check"></i><b>8</b> Multilevel Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#basketball-referees-dataset"><i class="fa fa-check"></i><b>8.1</b> Basketball Referees Dataset</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#data-overview"><i class="fa fa-check"></i><b>8.1.1</b> Data Overview</a></li>
<li class="chapter" data-level="8.1.2" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#histograms-for-level-one-covariates"><i class="fa fa-check"></i><b>8.1.2</b> Histograms for Level One Covariates</a></li>
<li class="chapter" data-level="8.1.3" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#average-fouls-by-team"><i class="fa fa-check"></i><b>8.1.3</b> Average Fouls by Team</a></li>
<li class="chapter" data-level="8.1.4" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#examining-bivariate-relationships"><i class="fa fa-check"></i><b>8.1.4</b> Examining Bivariate Relationships</a></li>
<li class="chapter" data-level="8.1.5" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#tabular-summary-by-fouling-team"><i class="fa fa-check"></i><b>8.1.5</b> Tabular Summary by Fouling Team</a></li>
<li class="chapter" data-level="8.1.6" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#mosaic-plots"><i class="fa fa-check"></i><b>8.1.6</b> Mosaic Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#multilevel-generalized-linear-model"><i class="fa fa-check"></i><b>8.2</b> Multilevel Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#motivation-for-a-statistical-model"><i class="fa fa-check"></i><b>8.2.1</b> Motivation for a Statistical Model</a></li>
<li class="chapter" data-level="8.2.2" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#a-glm-approach"><i class="fa fa-check"></i><b>8.2.2</b> A GLM Approach</a></li>
<li class="chapter" data-level="8.2.3" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#adding-random-effect-for-game"><i class="fa fa-check"></i><b>8.2.3</b> Adding Random Effect for Game</a></li>
<li class="chapter" data-level="8.2.4" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#two-level-logistic-model"><i class="fa fa-check"></i><b>8.2.4</b> Two Level Logistic Model</a></li>
<li class="chapter" data-level="8.2.5" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#multilevel-glm-in-r"><i class="fa fa-check"></i><b>8.2.5</b> Multilevel GLM in R</a></li>
<li class="chapter" data-level="8.2.6" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#add-random-slope"><i class="fa fa-check"></i><b>8.2.6</b> Add Random Slope</a></li>
<li class="chapter" data-level="8.2.7" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#random-slopes-model-in-r-1"><i class="fa fa-check"></i><b>8.2.7</b> Random Slopes Model in R</a></li>
<li class="chapter" data-level="8.2.8" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#aic-bic-comparison"><i class="fa fa-check"></i><b>8.2.8</b> AIC, BIC Comparison</a></li>
<li class="chapter" data-level="8.2.9" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#random-error-terms"><i class="fa fa-check"></i><b>8.2.9</b> Random Error Terms</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#crossed-random-effects"><i class="fa fa-check"></i><b>8.3</b> Crossed Random Effects</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#random-effects-for-teams"><i class="fa fa-check"></i><b>8.3.1</b> Random Effects for Teams</a></li>
<li class="chapter" data-level="8.3.2" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#crossed-vs-nested-random-effects"><i class="fa fa-check"></i><b>8.3.2</b> Crossed vs Nested Random Effects</a></li>
<li class="chapter" data-level="8.3.3" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#models-for-crossed-random-effects"><i class="fa fa-check"></i><b>8.3.3</b> Models for Crossed Random Effects</a></li>
<li class="chapter" data-level="8.3.4" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#fitting-model-with-crossed-random-effects-in-r"><i class="fa fa-check"></i><b>8.3.4</b> Fitting Model with Crossed Random Effects in R</a></li>
<li class="chapter" data-level="8.3.5" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#more-on-crossed-effects"><i class="fa fa-check"></i><b>8.3.5</b> More on Crossed Effects</a></li>
<li class="chapter" data-level="8.3.6" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#a-final-model-for-examining-referee-bias"><i class="fa fa-check"></i><b>8.3.6</b> A Final Model for Examining Referee Bias</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#parametric-bootstrapping"><i class="fa fa-check"></i><b>8.4</b> Parametric Bootstrapping</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#when-and-why-to-bootstrap"><i class="fa fa-check"></i><b>8.4.1</b> When and Why to Bootstrap</a></li>
<li class="chapter" data-level="8.4.2" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#parametric-bootstrap-procedure"><i class="fa fa-check"></i><b>8.4.2</b> Parametric Bootstrap Procedure</a></li>
<li class="chapter" data-level="8.4.3" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#a-simple-example"><i class="fa fa-check"></i><b>8.4.3</b> A Simple Example</a></li>
<li class="chapter" data-level="8.4.4" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#parametric-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>8.4.4</b> Parametric Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="8.4.5" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#model-comparison-tests-with-parametric-bootstrap"><i class="fa fa-check"></i><b>8.4.5</b> Model Comparison Tests with Parametric Bootstrap</a></li>
<li class="chapter" data-level="8.4.6" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#model-comparison-for-kentucky-derby-data"><i class="fa fa-check"></i><b>8.4.6</b> Model Comparison for Kentucky Derby Data</a></li>
<li class="chapter" data-level="8.4.7" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#code-for-boostrap-model-comparison"><i class="fa fa-check"></i><b>8.4.7</b> Code for Boostrap Model Comparison</a></li>
<li class="chapter" data-level="8.4.8" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#simulation-based-f-test"><i class="fa fa-check"></i><b>8.4.8</b> Simulation-Based F-Test</a></li>
<li class="chapter" data-level="8.4.9" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#model-comparison-in-multilevel-glm"><i class="fa fa-check"></i><b>8.4.9</b> Model Comparison in Multilevel GLM</a></li>
<li class="chapter" data-level="8.4.10" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#multilevel-glm-bootstrap-code"><i class="fa fa-check"></i><b>8.4.10</b> Multilevel GLM Bootstrap Code</a></li>
<li class="chapter" data-level="8.4.11" data-path="multilevel-generalized-linear-models.html"><a href="multilevel-generalized-linear-models.html#simulation-based-chi2-test"><i class="fa fa-check"></i><b>8.4.11</b> Simulation-Based <span class="math inline">\(\chi^2\)</span> Test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="epilogue.html"><a href="epilogue.html"><i class="fa fa-check"></i><b>9</b> Epilogue</a>
<ul>
<li class="chapter" data-level="9.1" data-path="epilogue.html"><a href="epilogue.html#further-directions"><i class="fa fa-check"></i><b>9.1</b> Further Directions</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="epilogue.html"><a href="epilogue.html#more-on-glms"><i class="fa fa-check"></i><b>9.1.1</b> More on GLM’s</a></li>
<li class="chapter" data-level="9.1.2" data-path="epilogue.html"><a href="epilogue.html#models-beyond-glms"><i class="fa fa-check"></i><b>9.1.2</b> Models Beyond GLM’s</a></li>
<li class="chapter" data-level="9.1.3" data-path="epilogue.html"><a href="epilogue.html#statistics-courses-at-lawrence"><i class="fa fa-check"></i><b>9.1.3</b> Statistics Courses at Lawrence</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stat 455: Advanced Statistical Modeling Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multilevel-generalized-linear-models" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Multilevel Generalized Linear Models<a href="multilevel-generalized-linear-models.html#multilevel-generalized-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ol start="51" style="list-style-type: decimal">
<li><p>Interpret fixed and random effects in a generalized linear mixed effects model.</p></li>
<li><p>Write equations for generalized linear models in mathematical notation, including assumptions about distributions of random effects and error terms.</p></li>
</ol>
<p>These notes provide a summary of Chapter 11 in <a href="https://bookdown.org/roback/bookdown-BeyondMLR/">Beyond Multiple Linear Regression</a> by Roback and Legler. Much of the code that appears here comes from the textbook’s <a href="https://github.com/proback/BeyondMLR/">Github repository</a>.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="multilevel-generalized-linear-models.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages required for Chapter 11</span></span>
<span id="cb385-2"><a href="multilevel-generalized-linear-models.html#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb385-3"><a href="multilevel-generalized-linear-models.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb385-4"><a href="multilevel-generalized-linear-models.html#cb385-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb385-5"><a href="multilevel-generalized-linear-models.html#cb385-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb385-6"><a href="multilevel-generalized-linear-models.html#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb385-7"><a href="multilevel-generalized-linear-models.html#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb385-8"><a href="multilevel-generalized-linear-models.html#cb385-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb385-9"><a href="multilevel-generalized-linear-models.html#cb385-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>In basketball, do referees tend to “even out” calls over the course of a game? Is a team more likely to have a foul called on them if the last foul was called on the other team, or if the other team has had more fouls called in the game up to that point?</p>
<div id="basketball-referees-dataset" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Basketball Referees Dataset<a href="multilevel-generalized-linear-models.html#basketball-referees-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-overview" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Data Overview<a href="multilevel-generalized-linear-models.html#data-overview" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data was collected for 4972 fouls over 340 college basketball games during the 2009-2010 season. We focus on fouls called during the first half to avoid the issue of intentional fouls by the trailing team at the end of games.</p>
<p>The dataset includes the following variables.</p>
<ul>
<li><code>game</code> = unique game identification number</li>
<li><code>date</code> = date game was played (YYYYMMDD)</li>
<li><code>visitor</code> = visiting team abbreviation</li>
<li><code>hometeam</code> = home team abbreviation</li>
<li><code>foul.num</code> = cumulative foul number within game</li>
<li><code>foul.home</code> = indicator if foul was called on the home team</li>
<li><code>foul.diff</code> = the difference in fouls before the current foul was called (home - visitor)</li>
<li><code>score.diff</code> = the score differential before the current foul was called (home - visitor)</li>
<li><code>lead.home</code> = indicator if home team has the lead</li>
<li><code>previous.foul.home</code> = indicator if previous foul was called on the home team</li>
<li><code>foul.type</code> = categorical variable if current foul was offensive, personal, or shooting</li>
<li><code>time</code> = number of minutes left in the first half when foul called</li>
</ul>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="multilevel-generalized-linear-models.html#cb386-1" aria-hidden="true" tabindex="-1"></a>refdata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/proback/BeyondMLR/master/data/basketball0910.csv&quot;</span>)</span>
<span id="cb386-2"><a href="multilevel-generalized-linear-models.html#cb386-2" aria-hidden="true" tabindex="-1"></a>refdata <span class="ot">&lt;-</span> refdata <span class="sc">%&gt;%</span> <span class="fu">select</span>(game, visitor, hometeam, foul.num, foul.home, foul.diff, score.diff, lead.home, previous.foul.home, foul.type, time)</span>
<span id="cb386-3"><a href="multilevel-generalized-linear-models.html#cb386-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(refdata)       <span class="co"># examine first 6 rows</span></span></code></pre></div>
<pre><code>##   game visitor hometeam foul.num foul.home foul.diff score.diff lead.home
## 1    1      IA       MN        1         0         0          7         1
## 2    1      IA       MN        2         1        -1         10         1
## 3    1      IA       MN        3         1         0         11         1
## 4    1      IA       MN        4         0         1         11         1
## 5    1      IA       MN        5         0         0         14         1
## 6    1      IA       MN        6         0        -1         22         1
##   previous.foul.home foul.type      time
## 1                  0  Personal 14.166667
## 2                  0  Personal 11.433333
## 3                  1  Personal 10.233333
## 4                  1  Personal  9.733333
## 5                  0  Shooting  7.766667
## 6                  0  Shooting  5.566667</code></pre>
<p>For our initial analysis, our primary response variable is the binary variable <code>foul.home</code>.</p>
<p>Our hypothesis is that the probability a foul is called on the home team is inversely related to the foul differential; that is, if more fouls have been called on the home team than the visiting team, the next foul is less likely to be on the home team.</p>
<p>Our data are measured at multiple levels:</p>
<ul>
<li>Level 1 Observational Unit: Individual fouls<br />
</li>
<li>Level 1 Explanatory Variables: foul.num, foul.diff, score.diff, lead.home, previous.foul.home, time,</li>
<li>Level 2 Observational Unit: Games<br />
</li>
<li>Level 2 Variables: Home and Visiting Teams</li>
</ul>
<p>We don’t have data on these, but other potentially relevant level 2 variables might include attendance, or teams rankings.</p>
<p>Our response variable (whether or not the fouls was on the home team) is a binary variable that might be modeled using logistic regression.</p>
<p>We have not yet worked with logistic regression, or other generalized linear models, with multilevel datasets.</p>
</div>
<div id="histograms-for-level-one-covariates" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Histograms for Level One Covariates<a href="multilevel-generalized-linear-models.html#histograms-for-level-one-covariates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Histograms for the continuous Level One covariates (time remaining, foul differential, and score differential).</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="multilevel-generalized-linear-models.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize Level 1 covariates (and responses) by ignoring </span></span>
<span id="cb388-2"><a href="multilevel-generalized-linear-models.html#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="co"># within subject correlation and pretending all observations </span></span>
<span id="cb388-3"><a href="multilevel-generalized-linear-models.html#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="co"># are independent</span></span>
<span id="cb388-4"><a href="multilevel-generalized-linear-models.html#cb388-4" aria-hidden="true" tabindex="-1"></a>time.hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata, <span class="fu">aes</span>(<span class="at">x =</span> time)) <span class="sc">+</span> </span>
<span id="cb388-5"><a href="multilevel-generalized-linear-models.html#cb388-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb388-6"><a href="multilevel-generalized-linear-models.html#cb388-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time left in first half&quot;</span>) <span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(a)&quot;</span>)</span>
<span id="cb388-7"><a href="multilevel-generalized-linear-models.html#cb388-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-8"><a href="multilevel-generalized-linear-models.html#cb388-8" aria-hidden="true" tabindex="-1"></a>score.hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata, <span class="fu">aes</span>(<span class="at">x =</span> score.diff)) <span class="sc">+</span> </span>
<span id="cb388-9"><a href="multilevel-generalized-linear-models.html#cb388-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb388-10"><a href="multilevel-generalized-linear-models.html#cb388-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&quot;Score difference (home-visitor)&quot;</span>) <span class="sc">+</span></span>
<span id="cb388-11"><a href="multilevel-generalized-linear-models.html#cb388-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(b)&quot;</span>)</span>
<span id="cb388-12"><a href="multilevel-generalized-linear-models.html#cb388-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-13"><a href="multilevel-generalized-linear-models.html#cb388-13" aria-hidden="true" tabindex="-1"></a>foul.hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata, <span class="fu">aes</span>(<span class="at">x =</span> foul.diff)) <span class="sc">+</span> </span>
<span id="cb388-14"><a href="multilevel-generalized-linear-models.html#cb388-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,  <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb388-15"><a href="multilevel-generalized-linear-models.html#cb388-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&quot;Foul difference (home-visitor)&quot;</span>) <span class="sc">+</span></span>
<span id="cb388-16"><a href="multilevel-generalized-linear-models.html#cb388-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(c)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gmu-histmat1"></span>
<img src="Stat-455-Notes_files/figure-html/gmu-histmat1-1.png" alt="Histograms showing distributions of the 3 continuous Level One covariates: (a) time remaining, (b) score difference, and (c) foul difference." width="576" />
<p class="caption">
Figure 8.1: Histograms showing distributions of the 3 continuous Level One covariates: (a) time remaining, (b) score difference, and (c) foul difference.
</p>
</div>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="multilevel-generalized-linear-models.html#cb389-1" aria-hidden="true" tabindex="-1"></a>refdata <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Score_Diff=</span><span class="fu">mean</span>(score.diff),</span>
<span id="cb389-2"><a href="multilevel-generalized-linear-models.html#cb389-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Home_Ahead =</span> <span class="fu">mean</span>(score.diff<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb389-3"><a href="multilevel-generalized-linear-models.html#cb389-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Mean_Foul_Diff =</span> <span class="fu">mean</span>(foul.diff),</span>
<span id="cb389-4"><a href="multilevel-generalized-linear-models.html#cb389-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Prop_Fouls_Home=</span><span class="fu">mean</span>(foul.home) )</span></code></pre></div>
<pre><code>##   Mean_Score_Diff Home_Ahead Mean_Foul_Diff Prop_Fouls_Home
## 1        2.038013  0.5711987     -0.3596138       0.4794851</code></pre>
<p>On average, the home team is ahead by 2 points averaging across all observations. The home team is ahead in 57% of all observations.</p>
<p>48% of fouls called were against the home team. On average, the home team had 0.35 fewer fouls than the visitor at any given time.</p>
</div>
<div id="average-fouls-by-team" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Average Fouls by Team<a href="multilevel-generalized-linear-models.html#average-fouls-by-team" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Accounting for the effect of home and visiting team will likely be an important part of our model, since some teams tend to play in games with twice as many fouls called as others, and other teams see a noticeable disparity in the total number of fouls depending on if they are home or away.</p>
<table>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Home
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Visitor
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Difference
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Team
</th>
<th style="text-align:left;">
Fouls
</th>
<th style="text-align:left;">
Team
</th>
<th style="text-align:left;">
Fouls
</th>
<th style="text-align:left;">
Team
</th>
<th style="text-align:left;">
Fouls
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Top 3
</td>
<td style="text-align:left;">
Duke
</td>
<td style="text-align:left;">
20.0
</td>
<td style="text-align:left;">
WVa
</td>
<td style="text-align:left;">
21.4
</td>
<td style="text-align:left;">
Duke
</td>
<td style="text-align:left;">
4.0
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
VaTech
</td>
<td style="text-align:left;">
19.4
</td>
<td style="text-align:left;">
Nova
</td>
<td style="text-align:left;">
19.0
</td>
<td style="text-align:left;">
Wisc
</td>
<td style="text-align:left;">
2.6
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Nova
</td>
<td style="text-align:left;">
19.1
</td>
<td style="text-align:left;">
Wake
</td>
<td style="text-align:left;">
18.6
</td>
<td style="text-align:left;">
Pitt
</td>
<td style="text-align:left;">
2.3
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Bottom 3
</td>
<td style="text-align:left;">
Mich
</td>
<td style="text-align:left;">
10.6
</td>
<td style="text-align:left;">
Wisc
</td>
<td style="text-align:left;">
10.4
</td>
<td style="text-align:left;">
WVa
</td>
<td style="text-align:left;">
-6.9
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Ill
</td>
<td style="text-align:left;">
11.6
</td>
<td style="text-align:left;">
Mich
</td>
<td style="text-align:left;">
11.1
</td>
<td style="text-align:left;">
Mia
</td>
<td style="text-align:left;">
-2.7
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
MN
</td>
<td style="text-align:left;">
12.1
</td>
<td style="text-align:left;">
PSU
</td>
<td style="text-align:left;">
11.3
</td>
<td style="text-align:left;">
Clem
</td>
<td style="text-align:left;">
-2.6
</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Lots of fouls are called in games where Duke, VaTech, and Nova are the home team, or when WVa, Nova, or Wake are the away team.</p></li>
<li><p>Few fouls are called when Mich, Ill, and MN are the home team, or when Wisc, Mich, and PSU are the away team.</p></li>
<li><p>There are more total fouls called in games where Duke, Wisc, and Pitt are home than when they are away. The opposite is true of WVa, Mia, and Clem.</p></li>
</ul>
</div>
<div id="examining-bivariate-relationships" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Examining Bivariate Relationships<a href="multilevel-generalized-linear-models.html#examining-bivariate-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We begin by observing broad trends involving all 4972 fouls called, even though fouls from the same game may be correlated. The conditional density plots in the first row examine continuous Level One covariates.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="multilevel-generalized-linear-models.html#cb391-1" aria-hidden="true" tabindex="-1"></a>foul.df <span class="ot">&lt;-</span> refdata <span class="sc">%&gt;%</span></span>
<span id="cb391-2"><a href="multilevel-generalized-linear-models.html#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(foul.diff <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">7</span> <span class="sc">&amp;</span> foul.diff <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb391-3"><a href="multilevel-generalized-linear-models.html#cb391-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(foul.diff) <span class="sc">%&gt;%</span></span>
<span id="cb391-4"><a href="multilevel-generalized-linear-models.html#cb391-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">foul.phats =</span> <span class="fu">mean</span>(foul.home)) <span class="sc">%&gt;%</span></span>
<span id="cb391-5"><a href="multilevel-generalized-linear-models.html#cb391-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">foul.elogits =</span> <span class="fu">log</span>(foul.phats<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> foul.phats)) )</span></code></pre></div>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="multilevel-generalized-linear-models.html#cb392-1" aria-hidden="true" tabindex="-1"></a>score.df <span class="ot">&lt;-</span> refdata <span class="sc">%&gt;%</span></span>
<span id="cb392-2"><a href="multilevel-generalized-linear-models.html#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(score.diff <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">11</span> <span class="sc">&amp;</span> score.diff <span class="sc">&lt;=</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span></span>
<span id="cb392-3"><a href="multilevel-generalized-linear-models.html#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(score.diff) <span class="sc">%&gt;%</span></span>
<span id="cb392-4"><a href="multilevel-generalized-linear-models.html#cb392-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">score.phats =</span> <span class="fu">mean</span>(foul.home)) <span class="sc">%&gt;%</span></span>
<span id="cb392-5"><a href="multilevel-generalized-linear-models.html#cb392-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score.elogits =</span> <span class="fu">log</span>(score.phats<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> score.phats)) )</span></code></pre></div>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="multilevel-generalized-linear-models.html#cb393-1" aria-hidden="true" tabindex="-1"></a>time.df <span class="ot">&lt;-</span> refdata <span class="sc">%&gt;%</span> </span>
<span id="cb393-2"><a href="multilevel-generalized-linear-models.html#cb393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">cut</span>(time, </span>
<span id="cb393-3"><a href="multilevel-generalized-linear-models.html#cb393-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="cn">Inf</span>),</span>
<span id="cb393-4"><a href="multilevel-generalized-linear-models.html#cb393-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">19</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb393-5"><a href="multilevel-generalized-linear-models.html#cb393-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">times =</span> <span class="fu">as.numeric</span>(<span class="fu">levels</span>(group))[group]) <span class="sc">%&gt;%</span></span>
<span id="cb393-6"><a href="multilevel-generalized-linear-models.html#cb393-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>group) <span class="sc">%&gt;%</span></span>
<span id="cb393-7"><a href="multilevel-generalized-linear-models.html#cb393-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(times) <span class="sc">%&gt;%</span></span>
<span id="cb393-8"><a href="multilevel-generalized-linear-models.html#cb393-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">time.phats =</span> <span class="fu">mean</span>(foul.home)) <span class="sc">%&gt;%</span></span>
<span id="cb393-9"><a href="multilevel-generalized-linear-models.html#cb393-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time.elogits =</span> <span class="fu">log</span>(time.phats<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> time.phats)) )</span></code></pre></div>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="multilevel-generalized-linear-models.html#cb394-1" aria-hidden="true" tabindex="-1"></a>refdata <span class="ot">&lt;-</span> refdata <span class="sc">%&gt;%</span></span>
<span id="cb394-2"><a href="multilevel-generalized-linear-models.html#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">foul.factor =</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(foul.home <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb394-3"><a href="multilevel-generalized-linear-models.html#cb394-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;Home&quot;</span>, <span class="st">&quot;Visitor&quot;</span>)) )</span></code></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="multilevel-generalized-linear-models.html#cb395-1" aria-hidden="true" tabindex="-1"></a>foul.cd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata, <span class="fu">aes</span>(<span class="at">x =</span> foul.diff)) <span class="sc">+</span> </span>
<span id="cb395-2"><a href="multilevel-generalized-linear-models.html#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())  <span class="sc">+</span></span>
<span id="cb395-3"><a href="multilevel-generalized-linear-models.html#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> foul.factor), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>, </span>
<span id="cb395-4"><a href="multilevel-generalized-linear-models.html#cb395-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">adjust =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb395-5"><a href="multilevel-generalized-linear-models.html#cb395-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Foul difference (H-V)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-6"><a href="multilevel-generalized-linear-models.html#cb395-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability of Home Foul&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-7"><a href="multilevel-generalized-linear-models.html#cb395-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;(a)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-8"><a href="multilevel-generalized-linear-models.html#cb395-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey20&quot;</span>, <span class="st">&quot;grey80&quot;</span>))</span>
<span id="cb395-9"><a href="multilevel-generalized-linear-models.html#cb395-9" aria-hidden="true" tabindex="-1"></a>score.cd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata, <span class="fu">aes</span>(<span class="at">x =</span> score.diff)) <span class="sc">+</span> </span>
<span id="cb395-10"><a href="multilevel-generalized-linear-models.html#cb395-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())  <span class="sc">+</span></span>
<span id="cb395-11"><a href="multilevel-generalized-linear-models.html#cb395-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> foul.factor), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>, </span>
<span id="cb395-12"><a href="multilevel-generalized-linear-models.html#cb395-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">adjust =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb395-13"><a href="multilevel-generalized-linear-models.html#cb395-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Score difference (H-V)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-14"><a href="multilevel-generalized-linear-models.html#cb395-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability of Home Foul&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-15"><a href="multilevel-generalized-linear-models.html#cb395-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;(b)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-16"><a href="multilevel-generalized-linear-models.html#cb395-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey20&quot;</span>, <span class="st">&quot;grey80&quot;</span>))</span>
<span id="cb395-17"><a href="multilevel-generalized-linear-models.html#cb395-17" aria-hidden="true" tabindex="-1"></a>time.cd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata, <span class="fu">aes</span>(<span class="at">x =</span> time)) <span class="sc">+</span> </span>
<span id="cb395-18"><a href="multilevel-generalized-linear-models.html#cb395-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb395-19"><a href="multilevel-generalized-linear-models.html#cb395-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> foul.factor), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>, </span>
<span id="cb395-20"><a href="multilevel-generalized-linear-models.html#cb395-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">adjust =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb395-21"><a href="multilevel-generalized-linear-models.html#cb395-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time left in half&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-22"><a href="multilevel-generalized-linear-models.html#cb395-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability of Home Foul&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-23"><a href="multilevel-generalized-linear-models.html#cb395-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;(c)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-24"><a href="multilevel-generalized-linear-models.html#cb395-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey20&quot;</span>, <span class="st">&quot;grey80&quot;</span>))</span>
<span id="cb395-25"><a href="multilevel-generalized-linear-models.html#cb395-25" aria-hidden="true" tabindex="-1"></a>foul.el <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> foul.df, <span class="fu">aes</span>(<span class="at">x =</span> foul.diff, </span>
<span id="cb395-26"><a href="multilevel-generalized-linear-models.html#cb395-26" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> foul.elogits)) <span class="sc">+</span> </span>
<span id="cb395-27"><a href="multilevel-generalized-linear-models.html#cb395-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;dark grey&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Foul difference (H-V)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-28"><a href="multilevel-generalized-linear-models.html#cb395-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Empirical Log-odds of Home Foul&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-29"><a href="multilevel-generalized-linear-models.html#cb395-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(d)&quot;</span>) <span class="sc">+</span></span>
<span id="cb395-30"><a href="multilevel-generalized-linear-models.html#cb395-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb395-31"><a href="multilevel-generalized-linear-models.html#cb395-31" aria-hidden="true" tabindex="-1"></a>score.el <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> score.df, <span class="fu">aes</span>(<span class="at">x =</span> score.diff, </span>
<span id="cb395-32"><a href="multilevel-generalized-linear-models.html#cb395-32" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">y =</span> score.elogits)) <span class="sc">+</span> </span>
<span id="cb395-33"><a href="multilevel-generalized-linear-models.html#cb395-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;dark grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-34"><a href="multilevel-generalized-linear-models.html#cb395-34" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&quot;Score difference (H-V)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-35"><a href="multilevel-generalized-linear-models.html#cb395-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Empirical Log-odds of Home Foul&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-36"><a href="multilevel-generalized-linear-models.html#cb395-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(e)&quot;</span>) <span class="sc">+</span></span>
<span id="cb395-37"><a href="multilevel-generalized-linear-models.html#cb395-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb395-38"><a href="multilevel-generalized-linear-models.html#cb395-38" aria-hidden="true" tabindex="-1"></a>time.el <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> time.df, <span class="fu">aes</span>(<span class="at">x =</span> times, </span>
<span id="cb395-39"><a href="multilevel-generalized-linear-models.html#cb395-39" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">y =</span> time.elogits)) <span class="sc">+</span> </span>
<span id="cb395-40"><a href="multilevel-generalized-linear-models.html#cb395-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;dark grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-41"><a href="multilevel-generalized-linear-models.html#cb395-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&quot;Time left in half&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-42"><a href="multilevel-generalized-linear-models.html#cb395-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Empirical Log-odds of Home Foul&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-43"><a href="multilevel-generalized-linear-models.html#cb395-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(f)&quot;</span>) <span class="sc">+</span></span>
<span id="cb395-44"><a href="multilevel-generalized-linear-models.html#cb395-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gmu-cdelogitmat1"></span>
<img src="Stat-455-Notes_files/figure-html/gmu-cdelogitmat1-1.png" alt="Conditional density and empirical logit plots of the binary model response (foul called on home or visitor) vs. the three continuous Level One covariates (foul differential, score differential, and time remaining).  The dark shading in a conditional density plot shows the proportion of fouls called on the home team for a fixed value of (a) foul differential, (b) score differential, and (c) time remaining.  In empirical logit plots, estimated log odds of a home team foul are calculated for each distinct foul (d) and score (e) differential, except for differentials at the high and low extremes with insufficient data; for time (f), estimated log odds are calculated for two-minute time intervals and plotted against the midpoints of those intervals." width="960" />
<p class="caption">
Figure 8.2: Conditional density and empirical logit plots of the binary model response (foul called on home or visitor) vs. the three continuous Level One covariates (foul differential, score differential, and time remaining). The dark shading in a conditional density plot shows the proportion of fouls called on the home team for a fixed value of (a) foul differential, (b) score differential, and (c) time remaining. In empirical logit plots, estimated log odds of a home team foul are calculated for each distinct foul (d) and score (e) differential, except for differentials at the high and low extremes with insufficient data; for time (f), estimated log odds are calculated for two-minute time intervals and plotted against the midpoints of those intervals.
</p>
</div>
<p>Figure (a) provides support for our primary hypothesis about evening out foul calls, indicating a very strong trend for fouls to be more often called on the home team at points in the game when more fouls had previously been called on the visiting team.</p>
<p>Figures (b) and (c) then show that fouls were somewhat more likely to be called on the home team when the home team’s lead was greater and (very slightly) later in the half.</p>
<p>Conclusions from the conditional density plots in Figures (a)-(c) are supported with associated empirical logit plots in Figures (d)-(f). If a logistic link function is appropriate, these plots should be linear, and the stronger the linear association, the more promising the predictor.</p>
<p>We see in Figure (d) further confirmation of our primary hypothesis, with lower log-odds of a foul called on the home team associated with a greater number of previous fouls the home team had accumulated compared to the visiting team.</p>
<p>Figure (e) shows that game score may play a role in foul trends, as the log-odds of a foul on the home team grows as the home team accumulates a bigger lead on the scoreboard.</p>
<p>Figure (f) shows a very slight tendency for greater log-odds of a foul called on the home team as the half proceeds (since points on the right are closer to the beginning of the game).</p>
</div>
<div id="tabular-summary-by-fouling-team" class="section level3 hasAnchor" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> Tabular Summary by Fouling Team<a href="multilevel-generalized-linear-models.html#tabular-summary-by-fouling-team" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="multilevel-generalized-linear-models.html#cb396-1" aria-hidden="true" tabindex="-1"></a>refdata <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(foul.home) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_foul.diff=</span><span class="fu">mean</span>(foul.diff), </span>
<span id="cb396-2"><a href="multilevel-generalized-linear-models.html#cb396-2" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">Mean_diff=</span><span class="fu">mean</span>(score.diff), </span>
<span id="cb396-3"><a href="multilevel-generalized-linear-models.html#cb396-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">Mean_time=</span><span class="fu">mean</span>(time))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   foul.home Mean_foul.diff Mean_diff Mean_time
##       &lt;int&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1         0         -0.102      1.41      9.50
## 2         1         -0.639      2.72      9.23</code></pre>
<p>Conclusions about continuous Level One covariates are further supported by summary statistics calculated separately for fouls called on the home team and those called on the visiting team. For instance, when a foul is called on the home team, there is an average of 0.64 additional fouls on the visitors at that point in the game, compared to an average of 0.10 additional fouls on the visitors when a foul is called on the visiting team. Similarly, when a foul is called on the home team, they are in the lead by an average of 2.7 points, compared to an average home lead of 1.4 points when a foul is called on the visiting team. As expected, the average time remaining in the first half at the time of the foul is very similar for home teams and visitors (9.2 vs. 9.5 minutes, respectively).</p>
</div>
<div id="mosaic-plots" class="section level3 hasAnchor" number="8.1.6">
<h3><span class="header-section-number">8.1.6</span> Mosaic Plots<a href="multilevel-generalized-linear-models.html#mosaic-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="multilevel-generalized-linear-models.html#cb398-1" aria-hidden="true" tabindex="-1"></a>refdata <span class="ot">&lt;-</span> refdata <span class="sc">%&gt;%</span></span>
<span id="cb398-2"><a href="multilevel-generalized-linear-models.html#cb398-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leadyes =</span> <span class="fu">ifelse</span>(lead.home <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb398-3"><a href="multilevel-generalized-linear-models.html#cb398-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevyes =</span> <span class="fu">ifelse</span>(previous.foul.home <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb398-4"><a href="multilevel-generalized-linear-models.html#cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">whofoul =</span> foul.factor)</span>
<span id="cb398-5"><a href="multilevel-generalized-linear-models.html#cb398-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-6"><a href="multilevel-generalized-linear-models.html#cb398-6" aria-hidden="true" tabindex="-1"></a>barplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata) <span class="sc">+</span></span>
<span id="cb398-7"><a href="multilevel-generalized-linear-models.html#cb398-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">weight =</span> <span class="dv">1</span>, <span class="at">x =</span> <span class="fu">product</span>(whofoul, leadyes), </span>
<span id="cb398-8"><a href="multilevel-generalized-linear-models.html#cb398-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> whofoul)) <span class="sc">+</span></span>
<span id="cb398-9"><a href="multilevel-generalized-linear-models.html#cb398-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Home Team in Lead&quot;</span>) <span class="sc">+</span></span>
<span id="cb398-10"><a href="multilevel-generalized-linear-models.html#cb398-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Proportion within Leading Team&quot;</span>) <span class="sc">+</span> </span>
<span id="cb398-11"><a href="multilevel-generalized-linear-models.html#cb398-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(a)&quot;</span>) <span class="sc">+</span> <span class="fu">scale_fill_grey</span>() <span class="sc">+</span></span>
<span id="cb398-12"><a href="multilevel-generalized-linear-models.html#cb398-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span>
<span id="cb398-13"><a href="multilevel-generalized-linear-models.html#cb398-13" aria-hidden="true" tabindex="-1"></a>barplot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> refdata) <span class="sc">+</span></span>
<span id="cb398-14"><a href="multilevel-generalized-linear-models.html#cb398-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">weight =</span> <span class="dv">1</span>, <span class="at">x =</span> <span class="fu">product</span>(whofoul, prevyes), </span>
<span id="cb398-15"><a href="multilevel-generalized-linear-models.html#cb398-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> whofoul)) <span class="sc">+</span></span>
<span id="cb398-16"><a href="multilevel-generalized-linear-models.html#cb398-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Previous Foul on Home Team&quot;</span>) <span class="sc">+</span></span>
<span id="cb398-17"><a href="multilevel-generalized-linear-models.html#cb398-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Proportion within Previous Foul&quot;</span>) <span class="sc">+</span> </span>
<span id="cb398-18"><a href="multilevel-generalized-linear-models.html#cb398-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;(b)&quot;</span>) <span class="sc">+</span> <span class="fu">scale_fill_grey</span>() <span class="sc">+</span></span>
<span id="cb398-19"><a href="multilevel-generalized-linear-models.html#cb398-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gmu-barmat1"></span>
<img src="Stat-455-Notes_files/figure-html/gmu-barmat1-1.png" alt="Mosaic plots of the binary model response (foul called on home or visitor) vs. the categorical Level One covariates (team in the lead (a), and team called for the previous foul (b)).  Each bar shows the percentage of fouls called on the home team vs. the percentage of fouls called on the visiting team for a particular category of the covariate.  The bar width shows the proportion of fouls at each of the covariate levels." width="960" />
<p class="caption">
Figure 8.3: Mosaic plots of the binary model response (foul called on home or visitor) vs. the categorical Level One covariates (team in the lead (a), and team called for the previous foul (b)). Each bar shows the percentage of fouls called on the home team vs. the percentage of fouls called on the visiting team for a particular category of the covariate. The bar width shows the proportion of fouls at each of the covariate levels.
</p>
</div>
<p>Fouls were more likely to be called on the home team when the home team was leading, when the previous foul was on the visiting team</p>
</div>
</div>
<div id="multilevel-generalized-linear-model" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Multilevel Generalized Linear Model<a href="multilevel-generalized-linear-models.html#multilevel-generalized-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="motivation-for-a-statistical-model" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Motivation for a Statistical Model<a href="multilevel-generalized-linear-models.html#motivation-for-a-statistical-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The exploratory analyses presented above are an essential first step in understanding our data, seeing univariate trends, and noting bivariate relationships between variable pairs. However, our important research questions (a) involve the effect of foul differential after adjusting for other significant predictors of which team is called for a foul, (b) account for potential correlation between foul calls within a game (or within a particular home or visiting team), and (c) determine if the effect of foul differential is constant across game conditions. In order to address research questions such as these, we need to consider multilevel, multivariate statistical models for a binary response variable.</p>
<p>We’ll begin by modeling the probability of a foul on the home team, using foul difference as the explanatory variable.</p>
<p>Let <span class="math inline">\(Y_{ij}\)</span> represent an indicator variable for whether the <span class="math inline">\(j\)</span>th foul in game <span class="math inline">\(i\)</span> was on the home team. That is</p>
<p><span class="math display">\[ Y_{ij} =\begin{cases}
     1 &amp; \text{if $j$th foul in game $i$ was on home team}  \\
     0 &amp; \text{if $j$th foul in game $i$ was on away team }
   \end{cases}
\]</span></p>
<p>We assume:</p>
<p><span class="math display">\[
Y_{ij}\sim\text{Ber}(p_{ij})
\]</span></p>
<p>In an ordinary logistic regression model, we would say</p>
<p><span class="math display">\[ \log\bigg(\frac{p_{ij}}{1-p_{ij}}\bigg)=\beta_0+\beta_1\text{foul.diff}_{ij} \]</span></p>
</div>
<div id="a-glm-approach" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> A GLM Approach<a href="multilevel-generalized-linear-models.html#a-glm-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We fit the logistic regression model in R</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="multilevel-generalized-linear-models.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression model (not multilevel)</span></span>
<span id="cb399-2"><a href="multilevel-generalized-linear-models.html#cb399-2" aria-hidden="true" tabindex="-1"></a>M0 <span class="ot">=</span> <span class="fu">glm</span>(foul.home <span class="sc">~</span> foul.diff, </span>
<span id="cb399-3"><a href="multilevel-generalized-linear-models.html#cb399-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> binomial, <span class="at">data =</span> refdata)</span>
<span id="cb399-4"><a href="multilevel-generalized-linear-models.html#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M0)</span></code></pre></div>
<pre><code>
Call:
glm(formula = foul.home ~ foul.diff, family = binomial, data = refdata)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5817  -1.1227  -0.9654   1.1772   1.5225  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.13005    0.02912  -4.466 7.98e-06 ***
foul.diff   -0.13047    0.01426  -9.148  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 6884.3  on 4971  degrees of freedom
Residual deviance: 6798.1  on 4970  degrees of freedom
AIC: 6802.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div id="adding-random-effect-for-game" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Adding Random Effect for Game<a href="multilevel-generalized-linear-models.html#adding-random-effect-for-game" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ordinary logistic regression model, treats observations (fouls) as independent. We might expect fouls in the same game to be correlated. To account for this, we’ll add a random effect <span class="math inline">\(u_i\)</span> for games. This gives the link function:</p>
<p><span class="math display">\[ \log\bigg(\frac{p_{ij}}{1-p_{ij}}\bigg)=\beta_0+\beta_1\text{foul.diff}_{ij} + u_i, \]</span></p>
<p>where <span class="math inline">\(u_i\sim\mathcal{N}(0,\sigma_u^2)\)</span>.</p>
</div>
<div id="two-level-logistic-model" class="section level3 hasAnchor" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Two Level Logistic Model<a href="multilevel-generalized-linear-models.html#two-level-logistic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let <span class="math inline">\(Y_{ij}\)</span> represent an indicator variable for whether the <span class="math inline">\(j\)</span>th foul in game <span class="math inline">\(i\)</span> was on the home team. That is</p>
<p><span class="math display">\[ Y_{ij} =\begin{cases}
     1 &amp; \text{if $j$th foul in game $i$ was on home team}  \\
     0 &amp; \text{if $j$th foul in game $i$ was on away team }
   \end{cases}
\]</span></p>
<p>We assume:</p>
<p><span class="math display">\[
Y_{ij}\sim\text{Ber}(p_{ij})
\]</span></p>
<p>where,</p>
<p><span class="math display">\[ \log\bigg(\frac{p_{ij}}{1-p_{ij}}\bigg)=\beta_0+\beta_1\text{foul.diff}_{ij} + u_i, \]</span></p>
<p>and <span class="math inline">\(u_i\sim\mathcal{N}(0,\sigma_u^2)\)</span>.</p>
</div>
<div id="multilevel-glm-in-r" class="section level3 hasAnchor" number="8.2.5">
<h3><span class="header-section-number">8.2.5</span> Multilevel GLM in R<a href="multilevel-generalized-linear-models.html#multilevel-glm-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We fit a multilevel generalized linear model in R using the <code>glmer()</code> function.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="multilevel-generalized-linear-models.html#cb401-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(foul.home <span class="sc">~</span> foul.diff <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>game), <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> refdata)</span>
<span id="cb401-2"><a href="multilevel-generalized-linear-models.html#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: foul.home ~ foul.diff + (1 | game)
##    Data: refdata
## 
##      AIC      BIC   logLik deviance df.resid 
##   6792.5   6812.1  -3393.3   6786.5     4969 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.6995 -0.9055 -0.6518  0.9655  1.6849 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  game   (Intercept) 0.273    0.5225  
## Number of obs: 4972, groups:  game, 340
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.18886    0.04434  -4.259 2.05e-05 ***
## foul.diff   -0.26821    0.03895  -6.887 5.71e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr)
## foul.diff 0.368</code></pre>
<p>Assuming the foul differential is even, the odds of a foul being called on the home team are: <span class="math inline">\(e^{-0.18886} = 0.83:1\)</span></p>
<p>Equivalently, the probability of a foul called going against the home team when the foul differential is even is <span class="math inline">\(\frac{e^{-0.18886}}{1+e^{-0.18886}}\approx0.45\)</span>.</p>
<p>Considering foul differential, for each additional fouls that the home team has, compared to the away team, the odds of the next foul going against the home team multiply by a factor of <span class="math inline">\(e^{-0.26821} = 0.76\)</span>, on average.</p>
<p>The estimate of <span class="math inline">\(\sigma_u\)</span> is 0.5225. This is the standard deviation in game level random effects. This is difficult to interpret in a meaningful way. (Why does it not represent the standard deviation in number of fouls called between different games?)</p>
<p>Notice that estimates change after accounting for in-game correlation, and standard errors increase.</p>
</div>
<div id="add-random-slope" class="section level3 hasAnchor" number="8.2.6">
<h3><span class="header-section-number">8.2.6</span> Add Random Slope<a href="multilevel-generalized-linear-models.html#add-random-slope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The previous model assumes that the effect of foul differential on the probability of the next foul going on the home team is the same across games.</p>
<p>We might add a random slope term to allow this effect to vary between games.</p>
<p>Model:</p>
<p><span class="math display">\[
Y_{ij}\sim\text{Ber}(p_{ij})
\]</span></p>
<p>where,</p>
<p><span class="math display">\[ \log\bigg(\frac{p_{ij}}{1-p_{ij}}\bigg)=\beta_0+\beta_1\text{foul.diff}_{ij} + u_i + v_i\text{foul.diff}_{ij}, \]</span></p>
<p>and
<span class="math display">\[ \left[ \begin{array}{c}
            u_i \\ v_i
          \end{array}  \right] \sim N \left( \left[
          \begin{array}{c}
            0 \\ 0
          \end{array} \right], \left[
          \begin{array}{cc}
            \sigma_{u}^{2} &amp; \\
            \sigma_{uv} &amp; \sigma_{v}^{2}
          \end{array} \right] \right) \]</span></p>
</div>
<div id="random-slopes-model-in-r-1" class="section level3 hasAnchor" number="8.2.7">
<h3><span class="header-section-number">8.2.7</span> Random Slopes Model in R<a href="multilevel-generalized-linear-models.html#random-slopes-model-in-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="multilevel-generalized-linear-models.html#cb403-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(foul.home <span class="sc">~</span> foul.diff <span class="sc">+</span> (foul.diff<span class="sc">|</span>game), </span>
<span id="cb403-2"><a href="multilevel-generalized-linear-models.html#cb403-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> refdata)</span>
<span id="cb403-3"><a href="multilevel-generalized-linear-models.html#cb403-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: foul.home ~ foul.diff + (foul.diff | game)
##    Data: refdata
## 
##      AIC      BIC   logLik deviance df.resid 
##   6791.1   6823.6  -3390.5   6781.1     4967 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.6399 -0.9087 -0.6349  0.9528  1.7687 
## 
## Random effects:
##  Groups Name        Variance Std.Dev. Corr 
##  game   (Intercept) 0.294144 0.54235       
##         foul.diff   0.001235 0.03514  -1.00
## Number of obs: 4972, groups:  game, 340
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.15684    0.04637  -3.382 0.000719 ***
## foul.diff   -0.28533    0.03835  -7.440 1.01e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr)
## foul.diff 0.192 
## optimizer (Nelder_Mead) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
</div>
<div id="aic-bic-comparison" class="section level3 hasAnchor" number="8.2.8">
<h3><span class="header-section-number">8.2.8</span> AIC, BIC Comparison<a href="multilevel-generalized-linear-models.html#aic-bic-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="multilevel-generalized-linear-models.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(M1)</span></code></pre></div>
<pre><code>## [1] 6792.54</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="multilevel-generalized-linear-models.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(M2)</span></code></pre></div>
<pre><code>## [1] 6791.072</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="multilevel-generalized-linear-models.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(M1)</span></code></pre></div>
<pre><code>## [1] 6812.075</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="multilevel-generalized-linear-models.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(M2)</span></code></pre></div>
<pre><code>## [1] 6823.63</code></pre>
<p>It’s not clear that adding the random slope makes much difference or is warranted.</p>
</div>
<div id="random-error-terms" class="section level3 hasAnchor" number="8.2.9">
<h3><span class="header-section-number">8.2.9</span> Random Error Terms<a href="multilevel-generalized-linear-models.html#random-error-terms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[ Y_{ij} =\begin{cases}
     1 &amp; \text{if $j$th foul in game $i$ was on home team}  \\
     0 &amp; \text{if $j$th foul in game $i$ was on away team }
   \end{cases}
\]</span></p>
<p>We assume:</p>
<p><span class="math display">\[
Y_{ij}\sim\text{Ber}(p_{ij})
\]</span></p>
<p>where,</p>
<p><span class="math display">\[ \log\bigg(\frac{p_{ij}}{1-p_{ij}}\bigg)=\beta_0+\beta_1\text{foul.diff}_{ij} + u_i, \]</span></p>
<p>and <span class="math inline">\(u_i\sim\mathcal{N}(0,\sigma_u^2)\)</span>.</p>
<p><strong>Thought Question</strong> Why is there no <span class="math inline">\(\epsilon_{ij}\)</span> term in the link function?</p>
</div>
</div>
<div id="crossed-random-effects" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Crossed Random Effects<a href="multilevel-generalized-linear-models.html#crossed-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="random-effects-for-teams" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Random Effects for Teams<a href="multilevel-generalized-linear-models.html#random-effects-for-teams" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our exploratory analysis showed evidence that the probability a foul is called on the home team changes if we know precisely who the home and visiting teams are.</p>
<p>However, if we were to include an indicator variable for each distinct team, we would need 38 indicator variables for home teams and 38 more for visiting teams. This complicates the model and gives a lot of estimates we don’t really care about (since we’re not interested in comparing individual teams). It also means spending 38 degrees of freedom, which reduces precision of intervals and power of tests.</p>
<p>Instead, we can treat home and away team as random effects.</p>
</div>
<div id="crossed-vs-nested-random-effects" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Crossed vs Nested Random Effects<a href="multilevel-generalized-linear-models.html#crossed-vs-nested-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Besides the fact that our response variable is binary, there’s a fundamental difference in the nature of this model compared to prior random effects models we’ve seen.</p>
<p>Recall previous random effects models we’ve seen. For example, the plants in pots and trays.</p>
<p><img src="Ch10Ill.png" width="45%" /></p>
<p>In that study, we used random effects for trays, and for pots, but an individual pot could only be within one tray. Thus, all plants in the same pot were necessarily in the same tray. This is an example of <strong>nested random effects</strong>.</p>
<p>All other random effects models we’ve seen to this point have involved nested random effects.</p>
<p>By contrast, the same home team (an visiting team), appears in different games. Thus, the random effect for team is not nested within games. Game, home team, and visiting team are all level two variables, and none is nested in another. These are examples of <strong>crossed random effects</strong>.</p>
</div>
<div id="models-for-crossed-random-effects" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Models for Crossed Random Effects<a href="multilevel-generalized-linear-models.html#models-for-crossed-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When using notation like <span class="math inline">\(Y_{ijk}\)</span>, we’re used to having the observational unit indexed by <span class="math inline">\(k\)</span> nested within the observational unit indexed by <span class="math inline">\(j\)</span>, which is in turn nested within the observational unit indexed by <span class="math inline">\(i\)</span>.</p>
<p>We need a new notation to make sense of crossed random effects.</p>
<p>Let <span class="math inline">\(Y_{i[vh]j}\)</span> denote the <span class="math inline">\(j\)</span> foul in the <span class="math inline">\(i\)</span>th game involving visiting team <span class="math inline">\(v\)</span> and home team <span class="math inline">\(h\)</span>. We list <span class="math inline">\(v\)</span> and <span class="math inline">\(h\)</span> after <span class="math inline">\(i\)</span>, since they are on the same level as game, but place them inside brackets.</p>
<p>Then,</p>
<p><span class="math display">\[
Y_{i[vh]j}\sim\text{Ber}(p_{i[vh]j})
\]</span></p>
<p>where,</p>
<p><span class="math display">\[ \log\bigg(\frac{p_{i[vh]j}}{1-p_{i[vhj}}\bigg)=\beta_0+\beta_1\text{foul.diff}_{ij} + u_i + w_h+z_v. \]</span></p>
<p>We assume that the error terms are independent and normally distributed.</p>
<p><span class="math inline">\(u_i\sim\mathcal{N}(0,\sigma_u^2), w_h\sim\mathcal{N}(0,\sigma_w^2), z_v\sim\mathcal{N}(0,\sigma_z^2)\)</span>.</p>
<ul>
<li><span class="math inline">\(\beta_{0}\)</span> is the average log odds of a foul on the home team when the foul differential is 0 (fixed)<br />
</li>
<li><span class="math inline">\(\beta_{0}\)</span> is the average multiplicative increase in log odds of the next foul being on the home team, for every additional one foul differential in the home team’s favor<br />
</li>
<li><span class="math inline">\(u_{i}\)</span> is the effect of Game <span class="math inline">\(i\)</span> (random)</li>
<li><span class="math inline">\(w_{h}\)</span> is the effect of Home Team <span class="math inline">\(h\)</span> (random)<br />
</li>
<li><span class="math inline">\(z_{v}\)</span> is the effect of Visiting Team <span class="math inline">\(v\)</span> (random)</li>
</ul>
</div>
<div id="fitting-model-with-crossed-random-effects-in-r" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Fitting Model with Crossed Random Effects in R<a href="multilevel-generalized-linear-models.html#fitting-model-with-crossed-random-effects-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="multilevel-generalized-linear-models.html#cb413-1" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(foul.home <span class="sc">~</span> foul.diff <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>game) <span class="sc">+</span> </span>
<span id="cb413-2"><a href="multilevel-generalized-linear-models.html#cb413-2" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">|</span>hometeam) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visitor), </span>
<span id="cb413-3"><a href="multilevel-generalized-linear-models.html#cb413-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> refdata)</span>
<span id="cb413-4"><a href="multilevel-generalized-linear-models.html#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M3)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: foul.home ~ foul.diff + (1 | game) + (1 | hometeam) + (1 | visitor)
##    Data: refdata
## 
##      AIC      BIC   logLik deviance df.resid 
##   6780.5   6813.0  -3385.2   6770.5     4967 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.6589 -0.9056 -0.6522  0.9679  1.7952 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  game     (Intercept) 0.17164  0.4143  
##  hometeam (Intercept) 0.06809  0.2609  
##  visitor  (Intercept) 0.02323  0.1524  
## Number of obs: 4972, groups:  game, 340; hometeam, 39; visitor, 39
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.18780    0.06331  -2.967  0.00301 ** 
## foul.diff   -0.26385    0.03883  -6.795 1.09e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr)
## foul.diff 0.256</code></pre>
<p><strong>Interpretations</strong></p>
<ul>
<li><span class="math inline">\(\hat{\alpha}_{0}=-0.188=\)</span> the mean log odds of a home foul at the point where total fouls are equal between teams. In other words, when fouls are balanced between teams, the probability that a foul is called on the visiting team (.547) is 20.7% (<span class="math inline">\(1/e^{-.188}=1.207\)</span>) higher than the probability a foul is called on the home team (.453).</li>
<li><span class="math inline">\(\hat{\beta}_{0}=-0.264=\)</span> the decrease in mean log odds of a home foul for each 1 foul increase in the foul differential. More specifically, the odds the next foul is called on the visiting team rather than the home team increases by 30.2% with each additional foul called on the home team (<span class="math inline">\(1/e^{-.264}=1.302\)</span>).</li>
<li><span class="math inline">\(\hat{\sigma}_{u}^{2}=0.172=\)</span> the variance in log odds of foul going against home team from game-to-game.</li>
<li><span class="math inline">\(\hat{\sigma}_{w}^{2}=0.068=\)</span> the variance in log odds of foul going against home team among different home teams.</li>
<li><span class="math inline">\(\hat{\sigma}_{z}^{2}=0.023=\)</span> the variance in log odds of foul going against home team among different visiting teams.</li>
</ul>
<p>Based on the t-value (-6.80) and p-value (<span class="math inline">\(p&lt;.001\)</span>) associated with foul differential in this model, we have significant evidence of a negative association between foul differential and the odds of a home team foul. That is, we have significant evidence that the odds that a foul is called on the home team shrinks as the home team has more total fouls compared with the visiting team. Thus, there seems to be preliminary evidence in the 2009-2010 data that college basketball referees tend to even out foul calls over the course of the first half. Of course, we have yet to adjust for other significant covariates.</p>
<p>An estimated 65.4% of variability in the log odds of foul going against home team is due to differences from game-to-game, while 25.9% is due to differences among home teams, and 8.7% is due to differences among visiting teams.</p>
</div>
<div id="more-on-crossed-effects" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> More on Crossed Effects<a href="multilevel-generalized-linear-models.html#more-on-crossed-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although this was the only time we saw crossed random effects in this course, they are not unique to models with a binomial response. They could have come up in the linear mixed effects models we considered in the first half of the course.</p>
</div>
<div id="a-final-model-for-examining-referee-bias" class="section level3 hasAnchor" number="8.3.6">
<h3><span class="header-section-number">8.3.6</span> A Final Model for Examining Referee Bias<a href="multilevel-generalized-linear-models.html#a-final-model-for-examining-referee-bias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Section 11.7 in the <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-GLMM.html#sec:finalmodel-glmm">Roback and Legler text</a></p>
<p>provides a potential final model that accounts for score differential, time remaining, type of foul, and other potentially relevant covariates.</p>
<p>Among their conclusions, the authors write</p>
<p>“In general, we see a highly significant negative effect of foul differential—a strong tendency for referees to even out foul calls when one team starts amassing more fouls than the other. Important covariates to control for (because of their effects on the odds of a home foul) include score differential, whether the home team held the lead, time left in the first half, and the type of foul called.”</p>
</div>
</div>
<div id="parametric-bootstrapping" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Parametric Bootstrapping<a href="multilevel-generalized-linear-models.html#parametric-bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="when-and-why-to-bootstrap" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> When and Why to Bootstrap<a href="multilevel-generalized-linear-models.html#when-and-why-to-bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The maximum likelihood estimates, confidence intervals, and hypothesis tests that we’ve obtained throughout the class have been based on statistical theory telling us things like:</p>
<ol style="list-style-type: decimal">
<li>In LLSR and linear mixed effects models, regression coefficients follow <span class="math inline">\(t\)</span>-distributions.<br />
</li>
<li>In generalized linear regresson models, when the sample size is large, regression coefficients are approximately normally distributed.<br />
</li>
<li>Likelihood ratio based tests (like drop-in-deviance tests) follow <span class="math inline">\(\chi^2\)</span> distributions (or F-distributions for models based on quaasilikelihood).</li>
</ol>
<p>All of these are based on model assumptions, as well as “large-sample” theory which will never be exactly true, but are often reasonable approximations.</p>
<p>If we have doubts about model assumptions, like normality, or if our sample size is not that big, we might instead use a simulation-based method to calculate p-values and confidence intervals.</p>
<p>A popular simulation-based approach is the <strong>parametric bootstrap</strong>.</p>
<p>This is different than the bootstrapping procedude we learned in Stat 255, which is actually called the <strong>non-parametric bootstrap.</strong></p>
</div>
<div id="parametric-bootstrap-procedure" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Parametric Bootstrap Procedure<a href="multilevel-generalized-linear-models.html#parametric-bootstrap-procedure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Fit the model to the actual data to estimate all parameters (<span class="math inline">\(\beta\)</span>’s, <span class="math inline">\(\sigma\)</span>’s, etc.)<br />
</li>
<li>Simulate many datasets from model using estimated parameter values.<br />
</li>
<li>For each simulated dataset, estimate parameters using simulated data.<br />
</li>
<li>Calculate relevant statistics (t-statistics, F-statistics, Likelihood ratio’s, etc.)<br />
</li>
<li>Form confidence intervals using distribution of simulated values.</li>
</ol>
</div>
<div id="a-simple-example" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> A Simple Example<a href="multilevel-generalized-linear-models.html#a-simple-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll start with a simple example, using a LLSR model. Recall the Kentucky Derby Example in Chapter 1 of the notes.</p>
<p>We used a LSSR model to model a horse’s winning speed, with year (since) 1896 as the explanatory variable.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="multilevel-generalized-linear-models.html#cb415-1" aria-hidden="true" tabindex="-1"></a>derby.df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/proback/BeyondMLR/master/data/derbyplus.csv&quot;</span>)</span>
<span id="cb415-2"><a href="multilevel-generalized-linear-models.html#cb415-2" aria-hidden="true" tabindex="-1"></a>derby.df <span class="ot">&lt;-</span> derby.df <span class="sc">%&gt;%</span></span>
<span id="cb415-3"><a href="multilevel-generalized-linear-models.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">fast =</span> <span class="fu">ifelse</span>(condition<span class="sc">==</span><span class="st">&quot;fast&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb415-4"><a href="multilevel-generalized-linear-models.html#cb415-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">good =</span> <span class="fu">ifelse</span>(condition<span class="sc">==</span><span class="st">&quot;good&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb415-5"><a href="multilevel-generalized-linear-models.html#cb415-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">yearnew =</span> year <span class="sc">-</span> <span class="dv">1896</span>,</span>
<span id="cb415-6"><a href="multilevel-generalized-linear-models.html#cb415-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">fastfactor =</span> <span class="fu">ifelse</span>(fast <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;not fast&quot;</span>, <span class="st">&quot;fast&quot;</span>))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Fit the model to the actual data to estimate all parameters (<span class="math inline">\(\beta\)</span>’s, <span class="math inline">\(\sigma\)</span>’s, etc.)</li>
</ol>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="multilevel-generalized-linear-models.html#cb416-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(speed <span class="sc">~</span> yearnew, <span class="at">data =</span> derby.df)</span>
<span id="cb416-2"><a href="multilevel-generalized-linear-models.html#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)</span></code></pre></div>
<pre><code>
Call:
lm(formula = speed ~ yearnew, data = derby.df)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.08190 -0.50026  0.07387  0.67367  1.68720 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 51.588393   0.162549  317.37   &lt;2e-16 ***
yearnew      0.026126   0.002322   11.25   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9032 on 120 degrees of freedom
Multiple R-squared:  0.5134,    Adjusted R-squared:  0.5093 
F-statistic: 126.6 on 1 and 120 DF,  p-value: &lt; 2.2e-16</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Simulate many datasets from model using estimated parameter values, and<br />
</li>
<li>For each simulated dataset, estimate parameters using simulated data.</li>
</ol>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="multilevel-generalized-linear-models.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co"># record estimates from the model</span></span>
<span id="cb418-2"><a href="multilevel-generalized-linear-models.html#cb418-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb418-3"><a href="multilevel-generalized-linear-models.html#cb418-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb418-4"><a href="multilevel-generalized-linear-models.html#cb418-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">summary</span>(M)<span class="sc">$</span>sigma</span>
<span id="cb418-5"><a href="multilevel-generalized-linear-models.html#cb418-5" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb418-6"><a href="multilevel-generalized-linear-models.html#cb418-6" aria-hidden="true" tabindex="-1"></a>bootstrap_b0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, nreps))</span>
<span id="cb418-7"><a href="multilevel-generalized-linear-models.html#cb418-7" aria-hidden="true" tabindex="-1"></a>bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, nreps))</span>
<span id="cb418-8"><a href="multilevel-generalized-linear-models.html#cb418-8" aria-hidden="true" tabindex="-1"></a>bootstrap_sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, nreps))</span>
<span id="cb418-9"><a href="multilevel-generalized-linear-models.html#cb418-9" aria-hidden="true" tabindex="-1"></a>B_Data <span class="ot">&lt;-</span> derby.df</span>
<span id="cb418-10"><a href="multilevel-generalized-linear-models.html#cb418-10" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data and fit model</span></span>
<span id="cb418-11"><a href="multilevel-generalized-linear-models.html#cb418-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps){</span>
<span id="cb418-12"><a href="multilevel-generalized-linear-models.html#cb418-12" aria-hidden="true" tabindex="-1"></a>   <span class="co"># simulate new data</span></span>
<span id="cb418-13"><a href="multilevel-generalized-linear-models.html#cb418-13" aria-hidden="true" tabindex="-1"></a>B_Data <span class="ot">&lt;-</span> B_Data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">SimSpeed =</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>yearnew <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n=</span> <span class="fu">nrow</span>(derby.df), <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>sigma))</span>
<span id="cb418-14"><a href="multilevel-generalized-linear-models.html#cb418-14" aria-hidden="true" tabindex="-1"></a>Mb <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>B_Data, SimSpeed<span class="sc">~</span>yearnew)   <span class="co">#fit model to simulated data</span></span>
<span id="cb418-15"><a href="multilevel-generalized-linear-models.html#cb418-15" aria-hidden="true" tabindex="-1"></a>bootstrap_b0[i] <span class="ot">&lt;-</span> Mb<span class="sc">$</span>coefficients[<span class="dv">1</span>]        <span class="co">#record b0 from model on simulated data</span></span>
<span id="cb418-16"><a href="multilevel-generalized-linear-models.html#cb418-16" aria-hidden="true" tabindex="-1"></a>bootstrap_b1[i] <span class="ot">&lt;-</span> Mb<span class="sc">$</span>coefficients[<span class="dv">2</span>]        <span class="co">#record b1 from model on simulated data</span></span>
<span id="cb418-17"><a href="multilevel-generalized-linear-models.html#cb418-17" aria-hidden="true" tabindex="-1"></a>bootstrap_sigma[i] <span class="ot">&lt;-</span> <span class="fu">summary</span>(Mb)<span class="sc">$</span>sigma      <span class="co">#record sigma from model on simulated data</span></span>
<span id="cb418-18"><a href="multilevel-generalized-linear-models.html#cb418-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb418-19"><a href="multilevel-generalized-linear-models.html#cb418-19" aria-hidden="true" tabindex="-1"></a>Bootstrap_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(bootstrap_b0, bootstrap_b1, bootstrap_sigma)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Calculate relevant statistics (t-statistics, F-statistics, Likelihood ratio’s, etc.)<br />
</li>
<li>Form confidence intervals using distribution of simulated values.</li>
</ol>
</div>
<div id="parametric-bootstrap-confidence-intervals" class="section level3 hasAnchor" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> Parametric Bootstrap Confidence Intervals<a href="multilevel-generalized-linear-models.html#parametric-bootstrap-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="multilevel-generalized-linear-models.html#cb419-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap_Results, <span class="fu">aes</span>(<span class="at">x=</span>bootstrap_b0)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">quantile</span>(bootstrap_b0, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>)), <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb419-2"><a href="multilevel-generalized-linear-models.html#cb419-2" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Stat-455-Notes_files/figure-html/unnamed-chunk-265-1.png" width="576" /></p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="multilevel-generalized-linear-models.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(bootstrap_b0, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span></code></pre></div>
<pre><code>##     2.5%    97.5% 
## 51.26868 51.91032</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="multilevel-generalized-linear-models.html#cb422-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap_Results, <span class="fu">aes</span>(<span class="at">x=</span>bootstrap_b1)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">quantile</span>(bootstrap_b1, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>)), <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb422-2"><a href="multilevel-generalized-linear-models.html#cb422-2" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="Stat-455-Notes_files/figure-html/unnamed-chunk-267-1.png" width="576" /></p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="multilevel-generalized-linear-models.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(bootstrap_b1, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## 0.02163246 0.03069958</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="multilevel-generalized-linear-models.html#cb425-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap_Results, <span class="fu">aes</span>(<span class="at">x=</span>bootstrap_sigma)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">quantile</span>(bootstrap_sigma, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>)), <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb425-2"><a href="multilevel-generalized-linear-models.html#cb425-2" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="Stat-455-Notes_files/figure-html/unnamed-chunk-269-1.png" width="576" /></p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="multilevel-generalized-linear-models.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(bootstrap_sigma, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.7903002 1.0182309</code></pre>
<p>Theory-Based intervals (based on t-distribution)</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="multilevel-generalized-linear-models.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M)</span></code></pre></div>
<pre><code>##                   2.5 %      97.5 %
## (Intercept) 51.26655655 51.91022874
## yearnew      0.02152859  0.03072344</code></pre>
<p><strong>Thought Question:</strong> How is this approach to bootstrapping different than the non-parametric bootstrap we saw in 3.5.8 in the <a href="https://bookdown.org/ajsage/statistics_for_data_science_notes/">Stat 255 notes</a>? What assumption does the parametric bootstrap make that the non-parameteric bootstrap doesn’t?</p>
</div>
<div id="model-comparison-tests-with-parametric-bootstrap" class="section level3 hasAnchor" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> Model Comparison Tests with Parametric Bootstrap<a href="multilevel-generalized-linear-models.html#model-comparison-tests-with-parametric-bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distributions of ANOVA F-statistics and other likelihood-ratio-based test statistics for model comparison are vulnerable to deviations from model assumptions. When the assumptions are not valid, these stistics may not follow the distributions they are supposed to (F, <span class="math inline">\(\chi^2\)</span>), etc.</p>
<p>We can use parametric bootstrapping to approximate the null distribution of these statistics in such situations.</p>
<p>Process:</p>
<ol style="list-style-type: decimal">
<li>Fit <strong>full</strong> and <strong>reduced</strong> models and calculate relevant statistic (F-statistic, LRT statistic, etc.)<br />
</li>
<li>Simulate many datasets from the <strong>reduced model</strong> using estimated parameter values.<br />
</li>
<li>For each simulated dataset, fit the <strong>reduced model</strong> and <strong>full model</strong>.</li>
<li>Calculate statistic for model comparison (F-statistics, Likelihood ratio’s, etc.) on the models fit to the simulated data.<br />
</li>
<li>Look at where the statistic from the actual data (calculated in (1)) lies, relative to those calculated from the simulated data in (4). (Thought question: Under what assumption were these data simulated?). The simulation-based p-value is the proportion of simulated statistics as extreme or more extreme as the one we observed.</li>
</ol>
</div>
<div id="model-comparison-for-kentucky-derby-data" class="section level3 hasAnchor" number="8.4.6">
<h3><span class="header-section-number">8.4.6</span> Model Comparison for Kentucky Derby Data<a href="multilevel-generalized-linear-models.html#model-comparison-for-kentucky-derby-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="multilevel-generalized-linear-models.html#cb430-1" aria-hidden="true" tabindex="-1"></a>M_Red <span class="ot">&lt;-</span> <span class="fu">lm</span>(speed <span class="sc">~</span> yearnew, <span class="at">data =</span> derby.df)</span>
<span id="cb430-2"><a href="multilevel-generalized-linear-models.html#cb430-2" aria-hidden="true" tabindex="-1"></a>M_Full <span class="ot">&lt;-</span> <span class="fu">lm</span>(speed <span class="sc">~</span> yearnew <span class="sc">+</span> fast <span class="sc">+</span> yearnew<span class="sc">:</span>fast, <span class="at">data=</span>derby.df)</span>
<span id="cb430-3"><a href="multilevel-generalized-linear-models.html#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_Red, M_Full)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: speed ~ yearnew
## Model 2: speed ~ yearnew + fast + yearnew:fast
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    120 97.899                                  
## 2    118 58.991  2    38.908 38.914 1.048e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The observed F-statistic is 38.914. The associated p-value was calculated from an F-distribution with 2 and 118 df.</p>
<p>If we have concerns about model assumptions, especially normality, the F-statistic might not really follow this F-distribution.</p>
</div>
<div id="code-for-boostrap-model-comparison" class="section level3 hasAnchor" number="8.4.7">
<h3><span class="header-section-number">8.4.7</span> Code for Boostrap Model Comparison<a href="multilevel-generalized-linear-models.html#code-for-boostrap-model-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll simulate the distribution of the F-statistic, using the parametric bootstrap.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="multilevel-generalized-linear-models.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">02272022</span>)</span>
<span id="cb432-2"><a href="multilevel-generalized-linear-models.html#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="co"># record estimates from reduced model</span></span>
<span id="cb432-3"><a href="multilevel-generalized-linear-models.html#cb432-3" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> M_Red<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb432-4"><a href="multilevel-generalized-linear-models.html#cb432-4" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> M_Red<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb432-5"><a href="multilevel-generalized-linear-models.html#cb432-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">summary</span>(M_Red)<span class="sc">$</span>sigma</span>
<span id="cb432-6"><a href="multilevel-generalized-linear-models.html#cb432-6" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb432-7"><a href="multilevel-generalized-linear-models.html#cb432-7" aria-hidden="true" tabindex="-1"></a>bootstrap_F <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, nreps))</span>
<span id="cb432-8"><a href="multilevel-generalized-linear-models.html#cb432-8" aria-hidden="true" tabindex="-1"></a>B_Data <span class="ot">&lt;-</span> derby.df</span>
<span id="cb432-9"><a href="multilevel-generalized-linear-models.html#cb432-9" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data and fit model</span></span>
<span id="cb432-10"><a href="multilevel-generalized-linear-models.html#cb432-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps){</span>
<span id="cb432-11"><a href="multilevel-generalized-linear-models.html#cb432-11" aria-hidden="true" tabindex="-1"></a>   <span class="co"># simulate new data from reduced model</span></span>
<span id="cb432-12"><a href="multilevel-generalized-linear-models.html#cb432-12" aria-hidden="true" tabindex="-1"></a>B_Data <span class="ot">&lt;-</span> B_Data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">SimSpeed =</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>yearnew <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n=</span> <span class="fu">nrow</span>(derby.df), <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>sigma))</span>
<span id="cb432-13"><a href="multilevel-generalized-linear-models.html#cb432-13" aria-hidden="true" tabindex="-1"></a>Mb_Red <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>B_Data, SimSpeed<span class="sc">~</span>yearnew)   <span class="co">#fit reduced model to simulated data</span></span>
<span id="cb432-14"><a href="multilevel-generalized-linear-models.html#cb432-14" aria-hidden="true" tabindex="-1"></a>Mb_Full <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>B_Data, SimSpeed <span class="sc">~</span> yearnew <span class="sc">+</span> fast <span class="sc">+</span> yearnew<span class="sc">:</span>fast)   <span class="co">#fit full model to simulated data</span></span>
<span id="cb432-15"><a href="multilevel-generalized-linear-models.html#cb432-15" aria-hidden="true" tabindex="-1"></a>bootstrap_F[i] <span class="ot">&lt;-</span> <span class="fu">anova</span>(Mb_Full, Mb_Red)<span class="sc">$</span>F[<span class="dv">2</span>]</span>
<span id="cb432-16"><a href="multilevel-generalized-linear-models.html#cb432-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb432-17"><a href="multilevel-generalized-linear-models.html#cb432-17" aria-hidden="true" tabindex="-1"></a>Bootstrap_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(bootstrap_F)</span></code></pre></div>
</div>
<div id="simulation-based-f-test" class="section level3 hasAnchor" number="8.4.8">
<h3><span class="header-section-number">8.4.8</span> Simulation-Based F-Test<a href="multilevel-generalized-linear-models.html#simulation-based-f-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="multilevel-generalized-linear-models.html#cb433-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap_Results, <span class="fu">aes</span>(<span class="at">x=</span>bootstrap_F)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">38.914</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) </span>
<span id="cb433-2"><a href="multilevel-generalized-linear-models.html#cb433-2" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Stat-455-Notes_files/figure-html/unnamed-chunk-274-1.png" width="576" /></p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="multilevel-generalized-linear-models.html#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bootstrap_F<span class="sc">&gt;</span><span class="fl">38.914</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>None of our simulations produced a F-statistic even close to the one we observed in our actual data.</p>
<p>There is virtually no chance we would have obtained an F-statistic as large as we saw in the data by chance, if the reduced model was really appropriate. We have strong evidence that the full model is a better fit.</p>
<p>This is consistent with the theory-based F-test.</p>
</div>
<div id="model-comparison-in-multilevel-glm" class="section level3 hasAnchor" number="8.4.9">
<h3><span class="header-section-number">8.4.9</span> Model Comparison in Multilevel GLM<a href="multilevel-generalized-linear-models.html#model-comparison-in-multilevel-glm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="multilevel-generalized-linear-models.html#cb436-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(foul.home <span class="sc">~</span> foul.diff <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>game), </span>
<span id="cb436-2"><a href="multilevel-generalized-linear-models.html#cb436-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> refdata)</span>
<span id="cb436-3"><a href="multilevel-generalized-linear-models.html#cb436-3" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(foul.home <span class="sc">~</span> foul.diff <span class="sc">+</span> (foul.diff<span class="sc">|</span>game), </span>
<span id="cb436-4"><a href="multilevel-generalized-linear-models.html#cb436-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> refdata)</span></code></pre></div>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="multilevel-generalized-linear-models.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M1, M2)</span></code></pre></div>
<pre><code>## Data: refdata
## Models:
## M1: foul.home ~ foul.diff + (1 | game)
## M2: foul.home ~ foul.diff + (foul.diff | game)
##    npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
## M1    3 6792.5 6812.1 -3393.3   6786.5                       
## M2    5 6791.1 6823.6 -3390.5   6781.1 5.4682  2    0.06495 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The <span class="math inline">\(\chi^2\)</span> statistic of 5.4682 and fairly small p-value provide some evidence in favor of the larger model.</p>
<p>Research has shown that when estimates of variance and covariance of random effects are impacted by boundary constraints, “theory-based” tests like the <span class="math inline">\(\chi^2\)</span> test used here are too conservative and produce higher p-values than they should.</p>
</div>
<div id="multilevel-glm-bootstrap-code" class="section level3 hasAnchor" number="8.4.10">
<h3><span class="header-section-number">8.4.10</span> Multilevel GLM Bootstrap Code<a href="multilevel-generalized-linear-models.html#multilevel-glm-bootstrap-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fitting the model manually gets complicated. The <code>drop</code> and <code>simulate</code> functions in the <code>lme4</code> package do this automatically.</p>
<p>We’ll simulate data from the reduced model, fit both models, and calculate the <span class="math inline">\(\chi^2\)</span> statistic, and repeat this 1,000 times.</p>
<p>This establishes a bootstrap distribution for where we would expect this statistic to lie if the reduced model is actually “correct”.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="multilevel-generalized-linear-models.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This takes a LONG time to run!</span></span>
<span id="cb439-2"><a href="multilevel-generalized-linear-models.html#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">02272022</span>)</span>
<span id="cb439-3"><a href="multilevel-generalized-linear-models.html#cb439-3" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb439-4"><a href="multilevel-generalized-linear-models.html#cb439-4" aria-hidden="true" tabindex="-1"></a>ChiSq <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nreps)</span>
<span id="cb439-5"><a href="multilevel-generalized-linear-models.html#cb439-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps){</span>
<span id="cb439-6"><a href="multilevel-generalized-linear-models.html#cb439-6" aria-hidden="true" tabindex="-1"></a>SimData <span class="ot">&lt;-</span> <span class="fu">drop</span>(<span class="fu">simulate</span>(M1))  <span class="co"># this command simulates data directly from a model</span></span>
<span id="cb439-7"><a href="multilevel-generalized-linear-models.html#cb439-7" aria-hidden="true" tabindex="-1"></a>M1B <span class="ot">&lt;-</span><span class="fu">refit</span>(M1, <span class="at">newresp=</span>SimData)  <span class="co"># refits M1 to simulated data</span></span>
<span id="cb439-8"><a href="multilevel-generalized-linear-models.html#cb439-8" aria-hidden="true" tabindex="-1"></a>M2B <span class="ot">&lt;-</span><span class="fu">refit</span>(M2, <span class="at">newresp=</span>SimData)  <span class="co"># refits M2 to simulated data</span></span>
<span id="cb439-9"><a href="multilevel-generalized-linear-models.html#cb439-9" aria-hidden="true" tabindex="-1"></a>ChiSq[i] <span class="ot">&lt;-</span> <span class="fu">anova</span>(M1B,M2B)<span class="sc">$</span>Chisq[<span class="dv">2</span>]</span>
<span id="cb439-10"><a href="multilevel-generalized-linear-models.html#cb439-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb439-11"><a href="multilevel-generalized-linear-models.html#cb439-11" aria-hidden="true" tabindex="-1"></a>ChiSq<span class="ot">&lt;-</span> <span class="fu">write.csv</span>(ChiSq, <span class="at">file=</span><span class="st">&quot;ChiSq.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="simulation-based-chi2-test" class="section level3 hasAnchor" number="8.4.11">
<h3><span class="header-section-number">8.4.11</span> Simulation-Based <span class="math inline">\(\chi^2\)</span> Test<a href="multilevel-generalized-linear-models.html#simulation-based-chi2-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="multilevel-generalized-linear-models.html#cb440-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">data.frame</span>(ChiSq), <span class="fu">aes</span>(<span class="at">x=</span>ChiSq)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb440-2"><a href="multilevel-generalized-linear-models.html#cb440-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">5.4682</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) </span>
<span id="cb440-3"><a href="multilevel-generalized-linear-models.html#cb440-3" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="Stat-455-Notes_files/figure-html/unnamed-chunk-280-1.png" width="576" /></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="multilevel-generalized-linear-models.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ChiSq<span class="sc">&gt;</span><span class="fl">5.4682</span>)</span></code></pre></div>
<pre><code>## [1] 0.037</code></pre>
<p>The simulation-based p-value is 0.037. This is slightly smaller than the one based on the Chi-sqare distribution. Research has shown that when boundary constraints are an issue in estimating variance and correlation of random effects, “thory-based” tests are too conservative, and often yield p-values that are higher than they should be.</p>
<p>Our results are consistent with this observation.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="logistic-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="epilogue.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/STAT455-W22/stat455-w22-notes/edit/master/08-Generalized_Linear_Multilevel_Models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/STAT455-W22/stat455-w22-notes/blob/master/08-Generalized_Linear_Multilevel_Models.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
